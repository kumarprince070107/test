import{r as s,bQ as Ct,bR as Tt,bP as t,cp as kt}from"./vendor-BscbRrXe.js";import{R as ke,G as _t,V as _e,u as j,L as It,U as yt,S as ft,Q as vt,a as Ft,E as jt,A as wt,b as S,c as Rt,e as Pt,H as i,f as At,h as Ot,r as h,T as Vt,i as Lt,g as Nt,j as Bt}from"./index-Darz4a5I.js";import{b as o,d as Gt,i as Ut,c as qt,T as r,t as b}from"./fluentui-react-BLoVobkC.js";import"./fluentui-icons-F9KzHEr6.js";const Et="_askContainer_497rq_1",Mt="_askTopSection_497rq_15",Qt="_askBottomSection_497rq_29",Ht="_askTitle_497rq_49",zt="_askQuestionInput_497rq_61",Dt="_askAnswerContainer_497rq_73",Jt="_askAnalysisPanel_497rq_87",Kt="_askSettingsSeparator_497rq_97",Wt="_settingsButton_497rq_109",Xt="_commandsContainer_497rq_121",Yt="_commandButton_497rq_135",l={askContainer:Et,askTopSection:Mt,askBottomSection:Qt,askTitle:Ht,askQuestionInput:zt,askAnswerContainer:Dt,askAnalysisPanel:Jt,askSettingsSeparator:Kt,settingsButton:Wt,commandsContainer:Xt,commandButton:Yt};function Zt(){const[w,g]=s.useState(!1),[x,Ie]=s.useState(""),[R,$t]=s.useState(""),[P,es]=s.useState(""),[A,ye]=s.useState(.3),[C,fe]=s.useState(null),[O,ve]=s.useState(0),[V,Fe]=s.useState(0),[L,N]=s.useState(ke.Hybrid),[B,je]=s.useState(3),[T,G]=s.useState(!0),[U,we]=s.useState(!1),[u,Re]=s.useState(!1),[q,Pe]=s.useState(_t.TextAndImages),[k,Ae]=s.useState(""),[Oe,Ve]=s.useState(""),[Le,Ne]=s.useState([_e.Embedding,_e.ImageEmbedding]),[E,Be]=s.useState(!1),[M,Ge]=s.useState(!1),[Q,Ue]=s.useState(!1),[H,qe]=s.useState(!1),[Ee,Me]=s.useState(!1),[Qe,He]=s.useState(!1),[ze,De]=s.useState(!1),[Je,Ke]=s.useState(!1),[We,Xe]=s.useState(!1),[Ye,Ze]=s.useState(!1),$e=s.useRef(new Audio).current,[et,tt]=s.useState(!1),_=s.useRef(""),[I,z]=s.useState(!1),[p,D]=s.useState(),[c,st]=s.useState(),[at,J]=s.useState([]),nt={speechUrls:at,setSpeechUrls:J,audio:$e,isPlaying:et,setIsPlaying:tt},[K,W]=s.useState(),[m,d]=s.useState(void 0),X=j?Ct().instance:void 0,{loggedIn:y}=s.useContext(It),lt=async()=>{Lt().then(e=>{Ue(e.showGPT4VOptions),G(e.showSemanticRankerOption),qe(e.showSemanticRankerOption),Me(e.showVectorOption),e.showVectorOption||N(ke.Text),He(e.showUserUpload),De(e.showLanguagePicker),Ke(e.showSpeechInput),Xe(e.showSpeechOutputBrowser),Ze(e.showSpeechOutputAzure)})};s.useEffect(()=>{lt()},[]);const f=async e=>{_.current=e,p&&D(void 0),z(!0),W(void 0),d(void 0);const n=X?await Nt(X):void 0;try{const F={messages:[{content:e,role:"user"}],context:{overrides:{prompt_template:x.length===0?void 0:x,prompt_template_prefix:R.length===0?void 0:R,prompt_template_suffix:P.length===0?void 0:P,exclude_category:k.length===0?void 0:k,top:B,temperature:A,minimum_reranker_score:O,minimum_search_score:V,retrieval_mode:L,semantic_ranker:T,semantic_captions:U,use_oid_security_filter:E,use_groups_security_filter:M,vector_fields:Le,use_gpt4v:u,gpt4v_input:q,language:Ce.language,...C!==null?{seed:C}:{}}},session_state:c?c.session_state:null},Te=await Bt(F,n);console.log(Te),st(Te),J([null])}catch(F){D(F)}finally{z(!1)}},ot=(e,n)=>{Ie(n||"")},it=(e,n)=>{ye(parseFloat(n||"0"))},rt=(e,n)=>{fe(parseInt(n||""))},ct=(e,n)=>{Fe(parseFloat(n||"0"))},dt=(e,n)=>{ve(parseFloat(n||"0"))},ut=(e,n)=>{je(parseInt(n||"3"))},pt=(e,n)=>{G(!!n)},mt=(e,n)=>{we(!!n)},St=(e,n)=>{Ae(n||"")},ht=e=>{f(e),Ve(e)},bt=e=>{K===e&&m===S.CitationTab?d(void 0):(W(e),d(S.CitationTab))},v=e=>{d(m===e?void 0:e)},gt=(e,n)=>{Be(!!n)},xt=(e,n)=>{Ge(!!n)},Y=o("promptTemplate"),Z=o("promptTemplateField"),$=o("temperature"),ee=o("temperatureField"),te=o("seed"),se=o("seedField"),ae=o("searchScore"),ne=o("searchScoreField"),le=o("rerankerScore"),oe=o("rerankerScoreField"),ie=o("retrieveCount"),re=o("retrieveCountField"),ce=o("excludeCategory"),de=o("excludeCategoryField"),ue=o("semanticRanker"),pe=o("semanticRankerField"),me=o("semanticCaptions"),Se=o("semanticCaptionsField"),he=o("useOidSecurityFilter"),be=o("useOidSecurityFilterField"),ge=o("useGroupsSecurityFilter"),xe=o("useGroupsSecurityFilterField"),{t:a,i18n:Ce}=Tt();return t.jsxs("div",{className:l.askContainer,children:[t.jsx(kt,{children:t.jsx("title",{children:a("pageTitle")})}),t.jsxs("div",{className:l.askTopSection,children:[t.jsxs("div",{className:l.commandsContainer,children:[Qe&&t.jsx(yt,{className:l.commandButton,disabled:y}),t.jsx(ft,{className:l.commandButton,onClick:()=>g(!w)})]}),t.jsx("h1",{className:l.askTitle,children:a("askTitle")}),t.jsx("div",{className:l.askQuestionInput,children:t.jsx(vt,{placeholder:a("gpt4vExamples.placeholder"),disabled:I,initQuestion:Oe,onSend:e=>f(e),showSpeechInput:Je})})]}),t.jsxs("div",{className:l.askBottomSection,children:[I&&t.jsx(Gt,{label:a("generatingAnswer")}),!_.current&&t.jsxs("div",{className:l.askTopSection,children:[ze&&t.jsx(Ft,{onLanguageChange:e=>Ce.changeLanguage(e)}),t.jsx(jt,{onExampleClicked:ht,useGPT4V:u})]}),!I&&c&&!p&&t.jsx("div",{className:l.askAnswerContainer,children:t.jsx(wt,{answer:c,index:0,speechConfig:nt,isStreaming:!1,onCitationClicked:e=>bt(e),onThoughtProcessClicked:()=>v(S.ThoughtProcessTab),onSupportingContentClicked:()=>v(S.SupportingContentTab),showSpeechOutputAzure:Ye,showSpeechOutputBrowser:We})}),p?t.jsx("div",{className:l.askAnswerContainer,children:t.jsx(Rt,{error:p.toString(),onRetry:()=>f(_.current)})}):null,m&&c&&t.jsx(Pt,{className:l.askAnalysisPanel,activeCitation:K,onActiveTabChanged:e=>v(e),citationHeight:"600px",answer:c,activeTab:m})]}),t.jsxs(Ut,{headerText:a("labels.headerText"),isOpen:w,isBlocking:!1,onDismiss:()=>g(!1),closeButtonAriaLabel:a("labels.closeButton"),onRenderFooterContent:()=>t.jsx(qt,{onClick:()=>g(!1),children:a("labels.closeButton")}),isFooterAtBottom:!0,children:[t.jsx(r,{id:Z,className:l.chatSettingsSeparator,defaultValue:x,label:a("labels.promptTemplate"),multiline:!0,autoAdjustHeight:!0,onChange:ot,"aria-labelledby":Y,onRenderLabel:e=>t.jsx(i,{labelId:Y,fieldId:Z,helpText:a("helpTexts.promptTemplate"),label:e?.label})}),t.jsx(r,{id:ee,className:l.chatSettingsSeparator,label:a("labels.temperature"),type:"number",min:0,max:1,step:.1,defaultValue:A.toString(),onChange:it,"aria-labelledby":$,onRenderLabel:e=>t.jsx(i,{labelId:$,fieldId:ee,helpText:a("helpTexts.temperature"),label:e?.label})}),t.jsx(r,{id:se,className:l.chatSettingsSeparator,label:a("labels.seed"),type:"text",defaultValue:C?.toString()||"",onChange:rt,"aria-labelledby":te,onRenderLabel:e=>t.jsx(i,{labelId:te,fieldId:se,helpText:a("helpTexts.seed"),label:e?.label})}),t.jsx(r,{id:ne,className:l.chatSettingsSeparator,label:a("labels.minimumSearchScore"),type:"number",min:0,step:.01,defaultValue:V.toString(),onChange:ct,"aria-labelledby":ae,onRenderLabel:e=>t.jsx(i,{labelId:ae,fieldId:ne,helpText:a("helpTexts.searchScore"),label:e?.label})}),H&&t.jsx(r,{id:oe,className:l.chatSettingsSeparator,label:a("labels.minimumRerankerScore"),type:"number",min:1,max:4,step:.1,defaultValue:O.toString(),onChange:dt,"aria-labelledby":le,onRenderLabel:e=>t.jsx(i,{labelId:le,fieldId:oe,helpText:a("helpTexts.rerankerScore"),label:e?.label})}),t.jsx(r,{id:re,className:l.chatSettingsSeparator,label:a("labels.retrieveCount"),type:"number",min:1,max:50,defaultValue:B.toString(),onChange:ut,"aria-labelledby":ie,onRenderLabel:e=>t.jsx(i,{labelId:ie,fieldId:re,helpText:a("helpTexts.retrieveNumber"),label:e?.label})}),t.jsx(r,{id:de,className:l.chatSettingsSeparator,label:a("labels.excludeCategory"),defaultValue:k,onChange:St,"aria-labelledby":ce,onRenderLabel:e=>t.jsx(i,{labelId:ce,fieldId:de,helpText:a("helpTexts.excludeCategory"),label:e?.label})}),H&&t.jsxs(t.Fragment,{children:[t.jsx(b,{id:pe,className:l.chatSettingsSeparator,checked:T,label:a("labels.useSemanticRanker"),onChange:pt,"aria-labelledby":ue,onRenderLabel:e=>t.jsx(i,{labelId:ue,fieldId:pe,helpText:a("helpTexts.useSemanticReranker"),label:e?.label})}),t.jsx(b,{id:Se,className:l.chatSettingsSeparator,checked:U,label:a("labels.useSemanticCaptions"),onChange:mt,disabled:!T,"aria-labelledby":me,onRenderLabel:e=>t.jsx(i,{labelId:me,fieldId:Se,helpText:a("helpTexts.useSemanticCaptions"),label:e?.label})})]}),Q&&t.jsx(At,{gpt4vInputs:q,isUseGPT4V:u,updateUseGPT4V:e=>{Re(e)},updateGPT4VInputs:e=>Pe(e)}),Ee&&t.jsx(Ot,{defaultRetrievalMode:L,showImageOptions:u&&Q,updateVectorFields:e=>Ne(e),updateRetrievalMode:e=>N(e)}),j&&t.jsxs(t.Fragment,{children:[t.jsx(b,{id:be,className:l.chatSettingsSeparator,checked:E||h,label:a("labels.useOidSecurityFilter"),disabled:!y||h,onChange:gt,"aria-labelledby":he,onRenderLabel:e=>t.jsx(i,{labelId:he,fieldId:be,helpText:a("helpTexts.useOidSecurityFilter"),label:e?.label})}),t.jsx(b,{id:xe,className:l.chatSettingsSeparator,checked:M||h,label:a("labels.useGroupsSecurityFilter"),disabled:!y||h,onChange:xt,"aria-labelledby":ge,onRenderLabel:e=>t.jsx(i,{labelId:ge,fieldId:xe,helpText:a("helpTexts.useGroupsSecurityFilter"),label:e?.label})})]}),j&&t.jsx(Vt,{})]})]})}Zt.displayName="Ask";export{Zt as Component};
//# sourceMappingURL=Ask-rzQ-HxZU.js.map
