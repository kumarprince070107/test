const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Docs-ZC7OVyd3.js","assets/vendor-BscbRrXe.js","assets/fluentui-react-BLoVobkC.js","assets/fluentui-icons-F9KzHEr6.js","assets/Ask-rzQ-HxZU.js","assets/Ask-CItlEugh.css","assets/NoPage-D5z2sDZN.js"])))=>i.map(i=>d[i]);
import{r as o,bO as on,bP as e,bQ as _e,bR as A,bS as Be,bT as at,bU as ot,bV as rn,bW as cs,bX as ln,bY as cn,bZ as dn,b_ as ds,b$ as us,c0 as un,c1 as ps,c2 as pn,c3 as hn,c4 as hs,c5 as mn,c6 as gn,c7 as xn,B as fn,c8 as bn,c9 as yn,ca as Sn,cb as rt,cc as Ee,cd as vn,ce as jn,cf as _n,cg as Cn,ch as wn,ci as Tn,cj as kn,ck as In,cl as Ln,cm as An,cn as Nn,co as it}from"./vendor-BscbRrXe.js";import{D as Oe,T as se,I as te,S as R,P as Pn,a as ut,B as ge,u as Fn,b as y,C as ms,c as qe,d as En,e as Rn,M as Dn,f as Mn,L as $n,g as Bn,h as lt,i as gs,j as zn,k as xs,l as Re,m as On,n as qn,o as Zt,p as Un,q as Gn,r as Vn,s as es,t as me,v as Hn}from"./fluentui-react-BLoVobkC.js";import{D as Ue,e as Qn,E as Wn,M as ts,f as Kn,g as Jn,h as Yn,L as Xn,i as Zn}from"./fluentui-icons-F9KzHEr6.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();const ea="_container_mgrzp_1",ta="_chatRoot_mgrzp_15",sa="_chatContainer_mgrzp_25",na="_chatEmptyState_mgrzp_43",aa="_chatEmptyStateTitle_mgrzp_63",oa="_chatEmptyStateSubtitle_mgrzp_77",ra="_chatMessageStream_mgrzp_87",ia="_chatMessageGpt_mgrzp_111",la="_chatMessageGptMinWidth_mgrzp_123",ca="_chatInput_mgrzp_133",da="_chatAnalysisPanel_mgrzp_155",ua="_chatSettingsSeparator_mgrzp_171",pa="_loadingLogo_mgrzp_183",ha="_commandsSplitContainer_mgrzp_191",ma="_commandsContainer_mgrzp_201",ga="_commandButton_mgrzp_215",w={container:ea,chatRoot:ta,chatContainer:sa,chatEmptyState:na,chatEmptyStateTitle:aa,chatEmptyStateSubtitle:oa,chatMessageStream:ra,chatMessageGpt:ia,chatMessageGptMinWidth:la,chatInput:ca,chatAnalysisPanel:da,chatSettingsSeparator:ua,loadingLogo:pa,commandsSplitContainer:ha,commandsContainer:ma,commandButton:ga},xa="_leftSidebar_10cip_1",fa="_fileList_10cip_35",ba="_hidden_10cip_63",ya="_visible_10cip_69",Sa="_dropdownButton_10cip_89",va="_uploadButton_10cip_89",ja="_feedbackButton_10cip_89",_a="_uploadContainer_10cip_135",Ca="_scrollableList_10cip_203",wa="_searchInput_10cip_213",Ta="_deleteButton_10cip_229",ka="_dropbtn_10cip_261",Ia="_dropdownContent_10cip_285",La="_conversationOption_10cip_333",Aa="_noOptions_10cip_385",M={leftSidebar:xa,fileList:fa,hidden:ba,visible:ya,dropdownButton:Sa,uploadButton:va,feedbackButton:ja,uploadContainer:_a,scrollableList:Ca,searchInput:wa,deleteButton:Ta,dropbtn:ka,dropdownContent:Ia,conversationOption:La,noOptions:Aa},Na="_dropzone_1azxm_1",Pa={dropzone:Na},Fa=({handleUploadFile:s})=>{const t=o.useCallback(d=>{s(d[0])},[]),{acceptedFiles:n,getRootProps:r,getInputProps:a,isDragActive:i}=on({onDrop:t});return e.jsxs("div",{...r(),className:Pa.dropzone,children:[e.jsx("input",{...a()}),i?e.jsx("p",{children:"Drop the files here ..."}):e.jsx("p",{children:"Drag 'n' drop some files here, or click to select files"})]})},Ea=".auth/me",Ra=".auth/refresh",Da=".auth/logout?post_logout_redirect_uri=/";async function Ma(){const s=await fetch("/auth_setup");if(!s.ok)throw new Error(`auth setup response was not ok: ${s.status}`);return await s.json()}const fe=await Ma(),le=fe.useLogin,$e=fe.requireAccessControl,$a=fe.enableUnauthenticatedAccess,ss=$e&&!$a,Ba=fe.msalConfig,za=fe.loginRequest,Oa=fe.tokenRequest,fs=()=>window.location.origin+fe.msalConfig.auth.redirectUri;globalThis.cachedAppServicesToken=null;const Ge=()=>{const s=n=>{const r=new Date;return new Date(n.expires_on)>r};if(globalThis.cachedAppServicesToken&&s(globalThis.cachedAppServicesToken))return Promise.resolve(globalThis.cachedAppServicesToken);const t=()=>fetch(Ea).then(n=>n.ok?n.json().then(r=>r.length>0?{id_token:r[0].id_token,access_token:r[0].access_token,user_claims:r[0].user_claims.reduce((a,i)=>(a[i.typ]=i.val,a),{}),expires_on:r[0].expires_on}:null):null);return t().then(n=>n?s(n)?(globalThis.cachedAppServicesToken=n,n):fetch(Ra).then(r=>r.ok?t():null):null)},qa=await Ge()!=null,Ua=()=>{window.location.href=Da},pt=async s=>!!(s&&s.getActiveAccount()||await Ge()),ce=async s=>{const t=await Ge();return t?Promise.resolve(t.access_token):s.acquireTokenSilent({...Oa,redirectUri:fs()}).then(n=>n.accessToken).catch(n=>{console.log(n)})},ct=async s=>{const t=s.getActiveAccount();if(t)return t.username;const n=await Ge();return n?.user_claims?n.user_claims.preferred_username:null},Ga=async s=>{const t=s.getActiveAccount();if(t)return t.idTokenClaims;const n=await Ge();if(n)return n.user_claims},We="";async function Ce(s){return le&&!qa&&s?{Authorization:`Bearer ${s}`}:{}}async function Va(){return await(await fetch(`${We}/config`,{method:"GET"})).json()}async function uc(s,t){const n=await Ce(t),r=await fetch(`${We}/ask`,{method:"POST",headers:{...n,"Content-Type":"application/json"},body:JSON.stringify(s)});if(r.status>299||!r.ok)throw Error(`Request failed with status ${r.status}`);const a=await r.json();if(a.error)throw Error(a.error);return a}async function Ha(s,t,n){let r=`${We}/chat`;t&&(r+="/stream");const a=await Ce(n);return await fetch(r,{method:"POST",headers:{...a,"Content-Type":"application/json"},body:JSON.stringify(s)})}async function Qa(s){return await fetch("/speech",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:s})}).then(t=>t.status==200?t.blob():t.status==400?(console.log("Speech synthesis is not enabled."),null):(console.error("Unable to get speech synthesis."),null)).then(t=>t?URL.createObjectURL(t):null)}function bs(s){return`${We}/content/${s}`}async function ys(s,t){const n=await fetch("/upload",{method:"POST",headers:await Ce(t),body:s});if(!n.ok){const a=await n.text();throw console.error(`Error uploading file: ${n.status} - ${n.statusText}, Details: ${a}`),new Error(`Uploading files failed: ${n.statusText}`)}return await n.json()}async function Ss(s,t){const n=await Ce(t),r=await fetch("/delete_uploaded",{method:"POST",headers:{...n,"Content-Type":"application/json"},body:JSON.stringify({filename:s})});if(!r.ok)throw new Error(`Deleting file failed: ${r.statusText}`);return await r.json()}async function vs(s){const t=await fetch("/list_uploaded",{method:"GET",headers:await Ce(s)});if(!t.ok)throw new Error(`Listing files failed: ${t.statusText}`);return await t.json()}var U=(s=>(s.Hybrid="hybrid",s.Vectors="vectors",s.Text="text",s))(U||{}),re=(s=>(s.TextAndImages="textAndImages",s.Images="images",s.Texts="texts",s))(re||{}),Q=(s=>(s.Embedding="embedding",s.ImageEmbedding="imageEmbedding",s.Both="both",s))(Q||{});const je=o.createContext({loggedIn:!1,setLoggedIn:s=>{}}),Wa=20,Ka=({provider:s,isOpen:t,notify:n,onClose:r,onChatSelected:a,historyManager:i})=>{const[d,c]=o.useState([]),{loggedIn:u}=o.useContext(je),[p,x]=o.useState(!0),[f,L]=o.useState(!0);o.useState(!0);const[T,b]=o.useState(!0),[j,m]=o.useState(!0),[v,k]=o.useState(),[I,D]=o.useState(!1),[K,C]=o.useState([]),F=_e().instance,[be,B]=o.useState(!0),[Z,ye]=o.useState({}),[de,we]=o.useState([]),[mt,Te]=o.useState(!1),[ke,Je]=o.useState("");o.useState(!1);const Ie=o.useMemo(()=>Ye(de),[de]);function Ye(g){const S=new Date;S.setHours(0,0,0,0);const z=new Date(S);z.setDate(z.getDate()-1);const V=new Date(S);V.setDate(V.getDate()-7);const Y=new Date(S);return Y.setDate(Y.getDate()-30),g.reduce((X,ae)=>{const oe=new Date(ae.timestamp);let N;return oe>=S?N="history.today":oe>=z?N="history.yesterday":oe>=V?N="history.last7days":oe>=Y?N="history.last30days":N=oe.toLocaleDateString(void 0,{year:"numeric",month:"long"}),X[N]||(X[N]=[]),X[N].push(ae),X},{})}const Ve=async g=>{const S=await i.getItem(g);S&&a(S)};o.useEffect(()=>{we([]),i.resetContinuationToken(),Te(!0)},[]);const Xe=async g=>{D(!0);const S=g;console.log(S);const z=new FormData;z.append("file",S);try{const V=await ce(F);if(!V)throw new Error("No authentication token available");const Y=await ys(z,V);k(Y),D(!1),pe()}catch(V){console.error(V),D(!1)}},ue=async g=>{vs(g).then(S=>{B(!1),ye({}),C(S)})},Ze=async g=>{ye({...Z,[g]:"pending"});try{const S=await ce(F);if(!S)throw new Error("No authentication token available");await Ss(g,S),ye({...Z,[g]:"success"}),ue(S)}catch(S){ye({...Z,[g]:"error"}),console.error(S)}},[J,He]=o.useState(""),ne=d.filter(g=>g.text.toLowerCase().includes(J.toLowerCase())),Se=async g=>{await i.deleteItem(g),c(S=>S.filter(z=>z.key!==g))},pe=async()=>{try{const g=await ce(F);if(!g)throw new Error("No authentication token available");ue(g)}catch(g){console.error(g),B(!1)}};o.useEffect(()=>{t&&n&&(we([]),i.resetContinuationToken(),Te(!0))},[t,n]);const Le=async()=>{B(()=>!0);const g=await i.getNextItems(Wa);g.length===0&&Te(!1),we(S=>[...S,...g]),B(()=>!1)};return o.useEffect(()=>{pe()},[]),A(),o.useEffect(()=>{c(Object.entries(Ie).flatMap(([g,S])=>S.map(z=>({key:z.id,text:z.title}))))},[Ie]),e.jsx("div",{className:`${M.leftSidebar} ${M.visible}`,children:p&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{children:"Conversations"}),e.jsx(Oe,{className:M.dropdownWithSearch,placeholder:"Select a conversation",onClick:()=>Le(),options:ne.map(g=>({key:g.key,text:g.text})),onRenderOption:g=>e.jsxs("div",{className:M.conversationOption,children:[e.jsx("span",{children:g?.text}),e.jsx("button",{onClick:S=>{S.stopPropagation(),Se(g?.key)},className:M.deleteButton,children:e.jsx(Ue,{})})]}),onChange:(g,S)=>{S?.key&&Ve(String(S.key))}}),e.jsxs("div",{children:[e.jsxs("h3",{className:M.sectionHeader,onClick:()=>L(!f),children:["File Collection",e.jsx(Be,{icon:f?at:ot,className:M.sectionToggleIcon})]}),f&&e.jsxs("div",{children:[e.jsx("input",{type:"text",placeholder:"Search files...",className:M.searchInput,value:ke,onChange:g=>Je(g.target.value)}),e.jsx("div",{className:`${M.fileList} ${K.length>3?M.scrollableList:""}`,children:K.length>0?e.jsx("ul",{children:K.filter(g=>g.toLowerCase().includes(ke.toLowerCase())).map((g,S)=>e.jsxs("li",{children:[g,e.jsx("button",{className:M.deleteButton,onClick:()=>Ze(g),children:e.jsx(Ue,{})})]},S))}):e.jsx("p",{children:"No files uploaded yet."})})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:M.sectionHeader,onClick:()=>b(!T),children:["Quick Upload",e.jsx(Be,{icon:T?at:ot,className:M.sectionToggleIcon})]}),T&&e.jsxs("div",{className:M.uploadContainer,children:[I?null:e.jsx("p",{children:"Drop File Here"}),I?e.jsx("div",{children:e.jsx("p",{children:"1 file is uploading. Please wait..."})}):u?e.jsx(Fa,{handleUploadFile:Xe}):e.jsx("p",{children:"Please log in to upload files."})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:M.sectionHeader,onClick:()=>m(!j),children:["Feedback",e.jsx(Be,{icon:j?at:ot,className:M.sectionToggleIcon})]}),j&&e.jsxs("div",{children:[e.jsx(se,{placeholder:"Provide feedback here...",multiline:!0}),e.jsx("button",{className:M.feedbackButton,children:"Submit Feedback"})]})]})]})})},Ja="_answerContainer_1riem_1",Ya="_answerLogo_1riem_23",Xa="_answerText_1riem_31",Za="_selected_1riem_81",eo="_citationLearnMore_1riem_89",to="_citation_1riem_89",so="_followupQuestionsList_1riem_133",no="_followupQuestionLearnMore_1riem_141",ao="_followupQuestion_1riem_133",oo="_supContainer_1riem_179",ro="_retryButton_1riem_237",io="_loadingdots_1riem_281",lo="_loading_1riem_281",G={answerContainer:Ja,answerLogo:Ya,answerText:Xa,selected:Za,citationLearnMore:eo,citation:to,followupQuestionsList:so,followupQuestionLearnMore:no,followupQuestion:ao,supContainer:oo,retryButton:ro,loadingdots:io,loading:lo};function co(s,t,n){const r=[];let a=s.trim();if(t){let c=a.length;for(let p=a.length-1;p>=0&&a[p]!=="]";p--)if(a[p]==="["){c=p;break}a=a.substring(0,c)}return{answerHtml:a.split(/\[([^\]]+)\]/g).map((c,u)=>{if(u%2===0)return c;{let p;r.indexOf(c)!==-1?p=r.indexOf(c)+1:(r.push(c),p=r.length);const x=bs(c);return rn(e.jsx("a",{className:"supContainer",title:c,onClick:()=>n(x),children:e.jsx("sup",{children:p})}))}}).join(""),citations:r}}const js=()=>e.jsx(Qn,{primaryFill:"rgba(115, 118, 225, 1)","aria-hidden":"true","aria-label":"Answer logo"}),uo="Braein Data Explorer",po="Braein Data Explorer",ho="Chat",mo="Ask a question",go="Login",xo="Logout",fo="Clear chat",bo={chatHistory:"Chat history",openChatHistory:"Open chat history",noHistory:"No chat history",deleteModalTitle:"Delete chat history",deleteModalDescription:"This action cannot be undone. Delete this chat history?",deleteLabel:"Delete",cancelLabel:"Cancel",today:"Today",yesterday:"Yesterday",last7days:"Last 7 days",last30days:"Last 30 days"},yo={fileLabel:"Upload file:",uploadedFilesLabel:"Previously uploaded files:",noFilesUploaded:"No files uploaded yet",loading:"Loading...",manageFileUploads:"Manage file uploads",uploadingFiles:"Uploading files...",uploadedFileError:"Error uploading file - please try again or contact admin.",deleteFile:"Delete file",deletingFile:"Deleting file...",errorDeleting:"Error deleting.",fileDeleted:"File deleted"},So="Developer settings",vo="Explore your data",jo="Ask anything or try an example",_o={1:"What is included in my Northwind Health Plus plan that is not in standard?",2:"What happens in a performance review?",3:"What does a Product Manager do?",placeholder:"Type a new question (e.g. does my plan cover annual eye exams?)"},Co="Ask your data",wo={1:"Compare the impact of interest rates and GDP in financial markets.",2:"What is the expected trend for the S&P 500 index over the next five years? Compare it to the past S&P 500 performance",3:"Can you identify any correlation between oil prices and stock market trends?",placeholder:"Example: Does my plan cover annual eye exams?"},To="Generating answer",ko="Citation:",Io="Follow-up questions:",Lo={submitQuestion:"Submit question",askWithVoice:"Ask question with voice",stopRecording:"Stop recording question",showThoughtProcess:"Show thought process",showSupportingContent:"Show supporting content",speakAnswer:"Speak answer",info:"Info",save:"Save"},Ao={thoughtProcess:"Thought Process",supportingContent:"Supporting Content",citation:"Citation"},No={toggleMenu:"Toggle menu",languagePicker:"Select your language",headerText:"Configure answer generation",closeButton:"Close",promptTemplate:"Override prompt template",temperature:"Temperature",seed:"Seed",minimumSearchScore:"Minimum search score",minimumRerankerScore:"Minimum reranker score",retrieveCount:"Retrieve this many search results:",excludeCategory:"Exclude category",useSemanticRanker:"Use semantic ranker for retrieval",useSemanticCaptions:"Use semantic captions",useSuggestFollowupQuestions:"Suggest follow-up questions",useGPT4V:"Use GPT vision model",gpt4VInput:{label:"GPT vision model inputs",options:{textAndImages:"Images and text",images:"Images",texts:"Text"}},retrievalMode:{label:"Retrieval mode",options:{hybrid:"Vectors + Text (Hybrid)",vectors:"Vectors",texts:"Text"}},vector:{label:"Vector fields (Multi-query vector search)",options:{embedding:"Text Embeddings",imageEmbedding:"Image Embeddings",both:"Text and Image embeddings"}},useOidSecurityFilter:"Use oid security filter",useGroupsSecurityFilter:"Use groups security filter",shouldStream:"Stream chat completion responses"},Po={promptTemplate:"Overrides the prompt used to generate the answer based on the question and search results. To append to existing prompt instead of replace whole prompt, start your prompt with '>>>'.",temperature:"Sets the temperature of the request to the LLM that generates the answer. Higher temperatures result in more creative responses, but they may be less grounded.",seed:"Sets a seed to improve the reproducibility of the model's responses. The seed can be any integer.",searchScore:"Sets a minimum score for search results coming back from Azure AI search. The score range depends on whether you're using hybrid (default), vectors only, or text only.",rerankerScore:"Sets a minimum score for search results coming back from the semantic reranker. The score always ranges between 0-4. The higher the score, the more semantically relevant the result is to the question.",retrieveNumber:"Sets the number of search results to retrieve from Azure AI search. More results may increase the likelihood of finding the correct answer, but may lead to the model getting 'lost in the middle'.",excludeCategory:"Specifies a category to exclude from the search results. There are no categories used in the default data set.",useSemanticReranker:"Enables the Azure AI Search semantic ranker, a model that re-ranks search results based on semantic similarity to the user's query.",useSemanticCaptions:"Sends semantic captions to the LLM instead of the full search result. A semantic caption is extracted from a search result during the process of semantic ranking.",suggestFollowupQuestions:"Asks the LLM to suggest follow-up questions based on the user's query.",useGPT4Vision:"Uses GPT-4-Turbo with Vision to generate responses based on images and text from the index.",vectorFields:"Specifies which embedding fields in the Azure AI Search Index will be searched, both the 'Images and text' embeddings, 'Images' only, or 'Text' only.",gpt4VisionInputs:"Sets what will be sent to the vision model. 'Images and text' sends both images and text to the model, 'Images' sends only images, and 'Text' sends only text.",retrievalMode:"Sets the retrieval mode for the Azure AI Search query. `Vectors + Text (Hybrid)` uses a combination of vector search and full text search, `Vectors` uses only vector search, and `Text` uses only full text search. Hybrid is generally optimal.",streamChat:"Continuously streams the response to the chat UI as it is generated.",useOidSecurityFilter:"Filter search results based on the authenticated user's OID.",useGroupsSecurityFilter:"Filter search results based on the authenticated user's groups."},Fo={pageTitle:uo,headerTitle:po,chat:ho,qa:mo,login:go,logout:xo,clearChat:fo,history:bo,upload:yo,developerSettings:So,chatEmptyStateTitle:vo,chatEmptyStateSubtitle:jo,defaultExamples:_o,askTitle:Co,gpt4vExamples:wo,generatingAnswer:To,citationWithColon:ko,followupQuestions:Io,tooltips:Lo,headerTexts:Ao,labels:No,helpTexts:Po},Eo="Azure OpenAI + AI Search",Ro="Azure OpenAI + AI Search",Do="Chat",Mo="Haz una pregunta",$o="Iniciar sesión",Bo="Cerrar sesión",zo="Borrar chat",Oo={chatHistory:"Historial de chat",openChatHistory:"Abrir historial de chat",noHistory:"No hay historial de chat",deleteModalTitle:"Eliminar historial de chat",deleteModalDescription:"Esta acción no se puede deshacer. ¿Eliminar este historial de chat?",deleteLabel:"Eliminar",cancelLabel:"Cancelar",today:"Hoy",yesterday:"Ayer",last7days:"Últimos 7 días",last30days:"Últimos 30 días"},qo={fileLabel:"Subir archivo:",uploadedFilesLabel:"Archivos subidos previamente:",noFilesUploaded:"No se han subido archivos todavía",loading:"Cargando...",manageFileUploads:"Administrar subidas de archivos",uploadingFiles:"Subiendo archivos...",uploadedFileError:"Error al subir el archivo - por favor, inténtalo de nuevo o contacta con el administrador.",deleteFile:"Eliminar archivo",deletingFile:"Eliminando archivo...",errorDeleting:"Error eliminando.",fileDeleted:"Archivo eliminado"},Uo="Configuración del desarrollador",Go="Chatea con tus datos",Vo="Pregunta cualquier cosa o prueba un ejemplo",Ho={1:"¿Qué está incluido en mi plan Northwind Health Plus que no está en el estándar?",2:"¿Qué sucede en una revisión de rendimiento?",3:"¿Qué hace un Gerente de producto?",placeholder:"Escribe una nueva pregunta (por ejemplo, ¿mi plan cubre exámenes anuales de la vista?)"},Qo="Pregunta a tus datos",Wo={1:"Compara el impacto de las tasas de interés y el PIB en los mercados financieros.",2:"¿Cuál es la tendencia esperada para el índice S&P 500 en los próximos cinco años? Compáralo con el rendimiento pasado del S&P 500",3:"¿Puedes identificar alguna correlación entre los precios del petróleo y las tendencias del mercado de valores?",placeholder:"Ejemplo: ¿Mi plan cubre exámenes anuales de la vista?"},Ko="Generando respuesta",Jo="Cita:",Yo="Preguntas de seguimiento:",Xo={submitQuestion:"Enviar pregunta",askWithVoice:"Realizar pregunta con voz",stopRecording:"Detener la grabación de la pregunta",showThoughtProcess:"Mostrar proceso de pensamiento",showSupportingContent:"Mostrar contenido de soporte",speakAnswer:"Hablar respuesta",info:"Información",save:"Guardar"},Zo={thoughtProcess:"Proceso de Pensamiento",supportingContent:"Contenido de apoyo",citation:"Cita"},er={toggleMenu:"Alternar menú",languagePicker:"Seleccione su idioma",headerText:"Configurar la generación de respuestas",closeButton:"Cerrar",promptTemplate:"Sobrescribir plantilla de aviso",temperature:"Temperatura",seed:"Seed",minimumSearchScore:"Puntaje mínimo de búsqueda",minimumRerankerScore:"Puntaje mínimo de re-clasificación",retrieveCount:"Obtén éste número resultados de búsqueda:",excludeCategory:"Excluir categoría",useSemanticRanker:"Usar clasificador semántico para la recuperación",useSemanticCaptions:"Usar subtítulos semánticos",useSuggestFollowupQuestions:"Sugerir preguntas de seguimiento",useGPT4V:"Usar modelo de visión GPT",gpt4VInput:{label:"Entradas del modelo de visión GPT",options:{textAndImages:"Imágenes y texto",images:"Imágenes",texts:"Texto"}},retrievalMode:{label:"Modo de recuperación",options:{hybrid:"Vectores + Texto (Híbrido)",vectors:"Vectores",texts:"Texto"}},vector:{label:"Campos de vector (Búsqueda de vector de múltiples consultas)",options:{embedding:"Incrustaciones de texto",imageEmbedding:"Incrustaciones de imagen",both:"Incrustaciones de texto e imagen"}},useOidSecurityFilter:"Usar filtro de seguridad oid",useGroupsSecurityFilter:"Usar filtro de seguridad degrupos",shouldStream:"Transmitir respuestas de finalización de chat en tiempo real"},tr={promptTemplate:"Sobrescribe el aviso utilizado para generar la respuesta basada en la pregunta y los resultados de la búsqueda. Para agregar al aviso existente en lugar de reemplazar todo el aviso, comienza tu aviso con '>>>'.",temperature:"Establece la temperatura de la solicitud al LLM que genera la respuesta. Temperaturas más altas dan como resultado respuestas más creativas, pero pueden ser menos realistas.",seed:"Define un número entero para mejorar la reproducibilidad de las respuestas del modelo. El número de semilla se utiliza para generar respuestas más consistentes. El número de semilla puede ser cualquier número.",searchScore:"Establece una puntuación mínima para los resultados de búsqueda que vuelven de Azure AI search. El rango de puntuaciones depende de si estás utilizando híbrido (predeterminado), solo vectores o solo texto.",rerankerScore:"Establece una puntuación mínima para los resultados de búsqueda que vuelven del re-clasificador semántico. La puntuación siempre varía entre 0-4. Cuanto mayor es la puntuación, más relevante es semánticamente el resultado a la pregunta.",retrieveNumber:"Establece el número de resultados de búsqueda para recuperar de Azure AI search. Más resultados pueden aumentar la probabilidad de encontrar la respuesta correcta, pero pueden provocar que el modelo se 'pierda en el medio'.",excludeCategory:"Especifica una categoría para excluir de los resultados de búsqueda. No se utilizan categorías en el conjunto de datos predeterminado.",useSemanticReranker:"Habilita el re-clasificador semántico de Azure AI Search, un modelo que re-clasifica los resultados de búsqueda basándose en la similitud semántica con la consulta del usuario.",useSemanticCaptions:"Envía subtítulos semánticos al LLM en lugar del resultado de búsqueda completo. Un subtítulo semántico se extrae de un resultado de búsqueda durante el proceso de clasificación semántica.",suggestFollowupQuestions:"Pide al LLM que sugiera preguntas de seguimiento basándose en la consulta del usuario.",useGPT4Vision:"Utiliza GPT-4-Turbo con Visión para generar respuestas basándose en imágenes y texto del índice.",vectorFields:"Especifica qué campos de incrustación en el índice de búsqueda de Azure AI se buscarán, tanto las incrustaciones de 'Imágenes y texto', solo 'Imagenes', o solo 'Texto'.",gpt4VisionInputs:"Establece lo que se enviará al modelo de visión. 'Imágenes y texto' envía tanto imágenes como texto al modelo, 'Imágenes' solo envía imágenes y 'Texto' solo envía texto.",retrievalMode:"Establece el modo de recuperación para la consulta de búsqueda de Azure AI. Vectores + Texto (Híbrido) utiliza una combinación de búsqueda vectorial y búsqueda de texto completo, Vectores utiliza solo la búsqueda vectorial y Texto utiliza solo la búsqueda de texto completo. Generalmente, el modo híbrido es óptimo.",streamChat:"Transmite continuamente la respuesta a la interfaz de usuario del chat mientras se genera.",useOidSecurityFilter:"Filtra los resultados de búsqueda en función del OID del usuario autenticado.",useGroupsSecurityFilter:"Filtra los resultados de búsqueda en función de los grupos del usuario autenticado."},sr={pageTitle:Eo,headerTitle:Ro,chat:Do,qa:Mo,login:$o,logout:Bo,clearChat:zo,history:Oo,upload:qo,developerSettings:Uo,chatEmptyStateTitle:Go,chatEmptyStateSubtitle:Vo,defaultExamples:Ho,askTitle:Qo,gpt4vExamples:Wo,generatingAnswer:Ko,citationWithColon:Jo,followupQuestions:Yo,tooltips:Xo,headerTexts:Zo,labels:er,helpTexts:tr},nr="Azure OpenAI + AI Search",ar="Azure OpenAI + AI Search",or="チャット",rr="一問一答",ir="ログイン",lr="ログアウト",cr="チャットをクリア",dr={chatHistory:"チャット履歴",openChatHistory:"チャット履歴を開く",noHistory:"チャット履歴がありません",deleteModalTitle:"チャット履歴の削除",deleteModalDescription:"この操作は取り消せません。このチャット履歴を削除しますか？",deleteLabel:"削除",cancelLabel:"キャンセル",today:"今日",yesterday:"昨日",last7days:"過去7日間",last30days:"過去30日間"},ur={fileLabel:"ファイルをアップロード：",uploadedFilesLabel:"アップロード済みのファイル：",noFilesUploaded:"まだファイルがアップロードされていません",loading:"読み込み中...",manageFileUploads:"ファイルのアップロードを管理",uploadingFiles:"ファイルをアップロード中...",uploadedFileError:"ファイルのアップロードエラー - 再試行、もしくは管理者にお問い合わせください。",deleteFile:"ファイルを削除",deletingFile:"ファイルを削除中...",errorDeleting:"削除エラー。",fileDeleted:"ファイル削除済み"},pr="高度な設定",hr="データを用いてチャットを行います",mr="ご自由にお問い合わせいただくか、もしくは下記のサンプルをお試しください",gr={1:"私が契約中の Northwind Health Plus の標準プランには何が含まれ、何が含まれないのですか？",2:"パフォーマンス・レビューで何を行いますか？",3:"プロダクトマネージャーの職務内容について教えてください。",placeholder:"新しい質問を入力してください (例：私の契約プランは年1回の眼科検診もカバーしていますか？)"},xr="データを利用した問い合わせ",fr={1:"金融市場における金利とGDPの影響を比較してください。",2:"S&P 500指数の今後5年間のトレンドを予想してください、そして過去のS&P 500のパフォーマンスと比較してください。",3:"原油価格と株式市場の動向の間には相関関係があると思いますか？",placeholder:"例：私の契約プランは年1回の眼科検診もカバーしていますか？"},br="回答を生成中",yr="引用：",Sr="フォローアップの質問：",vr={submitQuestion:"質問を送信",askWithVoice:"音声で質問",stopRecording:"質問の記録を停止",showThoughtProcess:"思考プロセスの表示",showSupportingContent:"サポート内容の表示",speakAnswer:"音声による回答",info:"情報",save:"保存"},jr={thoughtProcess:"思考プロセス",supportingContent:"サポート内容",citation:"引用"},_r={toggleMenu:"メニューを切り替える",languagePicker:"言語の選択",headerText:"回答生成の設定",closeButton:"閉じる",promptTemplate:"プロンプト・テンプレートを上書き",temperature:"温度",seed:"シード",minimumSearchScore:"最小検索スコア",minimumRerankerScore:"最小リランキング・スコア",retrieveCount:"ここで指定する検索結果数を取得：",excludeCategory:"カテゴリを除外",useSemanticRanker:"取得にセマンティック・ランカーを使用",useSemanticCaptions:"セマンティック・キャプションを使用",useSuggestFollowupQuestions:"フォローアップの質問を提案",useGPT4V:"GPT Visionモデルを使用",gpt4VInput:{label:"GPT Visionモデルの入力",options:{textAndImages:"画像とテキスト",images:"画像",texts:"テキスト"}},retrievalMode:{label:"検索モード",options:{hybrid:"ベクトル + テキスト (ハイブリッド)",vectors:"ベクトル",texts:"テキスト"}},vector:{label:"ベクトルフィールド (マルチクエリベクトル検索)",options:{embedding:"テキスト埋め込み",imageEmbedding:"画像埋め込み",both:"テキストと画像の埋め込み"}},useOidSecurityFilter:"OIDセキュリティフィルターの使用",useGroupsSecurityFilter:"グループセキュリティフィルターの使用",shouldStream:"ストリームでチャット応答を取得"},Cr={promptTemplate:"質問や検索結果に基づいて回答を生成するためプロンプトを上書きします。既存のプロンプトに追加する場合、全てを置き換えるのではなく、プロンプトを'>>>'で始めてください。",temperature:"LLMで回答を生成する際、リクエストに対して温度を設定します。温度が高いほど、より創造的な回答が得られますが、不安定になる可能性があります。",seed:"モデルによる回答の再現性を向上させるためシードを設定します。シードは任意の整数に設定できます。",searchScore:"Azure AI Searchから返される検索結果の最小スコアを設定します。スコアの範囲は、ハイブリッド(デフォルト)、ベクトルのみ、またはテキストのみを使用しているかどうかによって異なります。",rerankerScore:"セマンティック・リランカーから返される検索結果の最小スコアを設定します。スコアの値は0から4の範囲で変更できます。スコアの値が大きいほど、質問に対する結果の意味的な関連性が高まります。",retrieveNumber:"Azure AI Searchの検索結果から取得する数を設定します。結果が多ければ多いほど、正しい答えを見つける可能性は高まるかもしれませんが、モデルが「途中で迷子になる」可能性もあります。",excludeCategory:"検索結果から除外するカテゴリを指定します。デフォルトのデータセットはカテゴリを使用していません。",useSemanticReranker:"Azure AI Searchのセマンティック・ランカーを有効にします(ユーザーのクエリに対するセマンティック類似性に基づいて検索結果をリランク付けするモデル)。",useSemanticCaptions:"完全な検索結果ではなく、LLMにセマンティック・キャプションを送信します。セマンティック・キャプションは、セマンティック・ランキングの処理中に検索結果から抽出されます。",suggestFollowupQuestions:"ユーザーのクエリに基づいて、LLMにフォローアップの質問を提案するように問い合わせます。",useGPT4Vision:"インデックスから画像とテキストを利用して回答を生成するためGPT-4-Turbo with Visionを使用します。",vectorFields:"Azure AI Search Index中でどの埋め込みフィールドを検索に利用するか指定します。「画像とテキスト」の両方、もしくは「画像」のみ、または「テキスト」のみのいずれかの埋め込みを指定します。",gpt4VisionInputs:"ビジョンモデルに送信する内容を設定します。「画像とテキスト」は画像とテキストの両方をモデルに送信し、「画像」は画像のみを送信し、「テキスト」はテキストのみを送信します。",retrievalMode:"Azure AI Searchクエリの取得モードを設定します。「ベクトル + テキスト (ハイブリッド)」はベクトル検索と全文検索の組み合わせを使用し、「ベクトル」はベクトル検索のみを使用し、「テキスト」は全文検索のみを使用します。一般的にはハイブリッド検索がお勧めです。",streamChat:"生成された回答をチャットUIに対して継続的にストリームで送信します。",useOidSecurityFilter:"認証ユーザーのOIDに基づいて検索結果をフィルタリングします。",useGroupsSecurityFilter:"認証ユーザーのグループに基づいて検索結果をフィルタリングします。"},wr={pageTitle:nr,headerTitle:ar,chat:or,qa:rr,login:ir,logout:lr,clearChat:cr,history:dr,upload:ur,developerSettings:pr,chatEmptyStateTitle:hr,chatEmptyStateSubtitle:mr,defaultExamples:gr,askTitle:xr,gpt4vExamples:fr,generatingAnswer:br,citationWithColon:yr,followupQuestions:Sr,tooltips:vr,headerTexts:jr,labels:_r,helpTexts:Cr},Tr="Azure OpenAI + AI Search",kr="Azure OpenAI + AI Search",Ir="Chat",Lr="Posez une question",Ar="Connexion",Nr="Déconnexion",Pr="Effacer le chat",Fr={chatHistory:"Historique du chat",openChatHistory:"Ouvrir l'historique du chat",noHistory:"Pas d'historique dans ce chat",deleteModalTitle:"Supprimer l'historique du chat",deleteModalDescription:"Cette action est irréversible. Supprimer l'historique de ce chat ?",deleteLabel:"Supprimer",cancelLabel:"Annuler",today:"Aujourd'hui",yesterday:"Hier",last7days:"7 derniers jours",last30days:"30 derniers jours"},Er={fileLabel:"Télécharger le fichier:",uploadedFilesLabel:"Fichiers précédemment téléchargés:",noFilesUploaded:"Aucun fichier téléchargé pour le moment",loading:"Chargement...",manageFileUploads:"Gérer les téléchargements de fichiers",uploadingFiles:"Téléchargement de fichiers...",uploadedFileError:"Erreur lors du téléchargement du fichier - veuillez réessayer ou contacter l'administrateur.",deleteFile:"Supprimer le fichier",deletingFile:"Suppression du fichier...",errorDeleting:"Erreur lors de la suppression.",fileDeleted:"Fichier supprimé"},Rr="Paramètres développeur",Dr="Discutez avec vos données",Mr="Demandez n'importe quoi ou essayez un exemple",$r={1:"Qu'est-ce qui est inclus dans mon plan Northwind Health Plus qui n'est pas dans le standard?",2:"Qu'arrive-t-il lors d'un examen de performance?",3:"Qu'est-ce qu'un Product Manager fait?",placeholder:"Tapez une nouvelle question (par exemple, mon plan couvre-t-il les examens oculaires annuels?)"},Br="Demandez à vos données",zr={1:"Comparez l'impact des taux d'intérêt et du PIB sur les marchés financiers.",2:"Quelle est la tendance prévue pour l'indice S&P 500 au cours des cinq prochaines années? Comparez-le aux performances passées de l'S&P 500",3:"Pouvez-vous identifier une corrélation entre les prix du pétrole et les tendances du marché boursier?",placeholder:"Exemple: Mon plan couvre-t-il les examens oculaires annuels?"},Or="Génération de la réponse",qr="Citation:",Ur="Questions de suivi:",Gr={submitQuestion:"Soumettre une question",askWithVoice:"Poser une question à l'aide de la voix",stopRecording:"Arrêter l'enregistrement de la question",showThoughtProcess:"Montrer le processus de réflexion",showSupportingContent:"Montrer le contenu de soutien",speakAnswer:"Parler réponse",info:"Info",save:"Sauvegarder"},Vr={thoughtProcess:"Processus de Réflexion",supportingContent:"Contenu d'Appui",citation:"Citation"},Hr={toggleMenu:"Basculer le menu",languagePicker:"Sélectionnez votre langue",headerText:"Configurer la génération de réponses",closeButton:"Fermer",promptTemplate:"Modèle de l'invitation",temperature:"Température",seed:"Seed",minimumSearchScore:"Score de recherche minimum",minimumRerankerScore:"Score minimum du reclasseur sémantique",retrieveCount:"Récupérer ce nombre de résultats de recherche :",excludeCategory:"Exclure la catégorie",useSemanticRanker:"Utiliser le reclasseur sémantique",useSemanticCaptions:"Utiliser les titres sémantiques",useSuggestFollowupQuestions:"Suggérer des questions de suivi",useGPT4V:"Utiliser le modèle GPT Vision",gpt4VInput:{label:"Entrées du modèle GPT Vision",options:{textAndImages:"Images et texte",images:"Images",texts:"Texte"}},retrievalMode:{label:"Mode de récupération",options:{hybrid:"Vecteurs + Texte (Hybride)",vectors:"Vecteurs",texts:"Texte"}},vector:{label:"Champs de vecteur (recherche de vecteur multi-requête)",options:{embedding:"Incorporations de texte",imageEmbedding:"Incorporations d'images",both:"Incorporations de texte et d'images"}},useOidSecurityFilter:"Utiliser le filtre de sécurité oid",useGroupsSecurityFilter:"Utiliser le filtre de sécurité de groupe",shouldStream:"Diffuser en continu les réponses"},Qr={promptTemplate:"Remplace le prompt utilisé pour générer la réponse en fonction de la question et des résultats de la recherche. Pour ajouter à l'invite existante au lieu de remplacer l'invite entière, commencez votre invite par '>>>'.",temperature:"Définit la température de la requête à le Grand modèle de langage (LLM) qui génère la réponse. Des températures plus élevées donnent lieu à des réponses plus créatives, mais elles peuvent être moins ancrées.",seed:"Détermine un numéro premier qui servira à améliorer la répétabilité des réponses du modèle. Le numéro premier doit être un entier quelconque.",searchScore:"Définit un score minimum pour les résultats de recherche provenant d'Azure AI Search. La plage de scores dépend si vous utilisez l'hybride (par défaut), uniquement les vecteurs, ou uniquement le texte.",rerankerScore:"Définit un score minimum pour les résultats de recherche provenant du reranker sémantique. Le score varie toujours entre 0 et 4. Plus le score est élevé, plus le résultat est sémantiquement pertinent par rapport à la question.",retrieveNumber:"Définit le nombre de résultats de recherche à récupérer d'Azure AI Search. Plus de résultats peuvent augmenter la probabilité de trouver la bonne réponse, mais peuvent amener le modèle à se 'perdre au milieu'.",excludeCategory:"Spécifie une catégorie à exclure des résultats de recherche. Il n'y a aucune catégorie utilisée dans l'ensemble de données par défaut.",useSemanticReranker:"Active le classement sémantique d'Azure AI Search, un modèle qui réorganise les résultats de recherche en fonction de la similarité sémantique avec la requête de l'utilisateur.",useSemanticCaptions:"Envoie des légendes sémantiques à l'LLM au lieu du résultat de recherche complet. Une légende sémantique est extraite d'un résultat de recherche lors du processus de classement sémantique.",suggestFollowupQuestions:"Demande à l'LLM de suggérer des questions de suivi en fonction de la requête de l'utilisateur.",useGPT4Vision:"Utilise GPT-4-Turbo avec Vision pour générer des réponses basées sur des images et du texte de l'index.",vectorFields:"Spécifie quels champs d'incorporation dans l'index de recherche Azure AI seront recherchés, à la fois les incorporations 'Images et texte', 'Images' seulement, ou 'Texte' seulement.",gpt4VisionInputs:"Définit ce qui sera envoyé au modèle de vision. 'Images et texte' envoie à la fois des images et du texte au modèle, 'Images' envoie seulement des images, et 'Texte' envoie seulement du texte.",retrievalMode:"Définit le mode de récupération pour la requête Azure AI Search. Vecteurs + Texte (Hybride) utilise une combinaison de recherche vectorielle et de recherche en texte intégral, Vecteurs utilise uniquement la recherche vectorielle, et Texte utilise uniquement la recherche en texte intégral. Hybride est généralement optimal.",streamChat:"Diffuse en continu la réponse à l'interface utilisateur du chat au fur et à mesure de sa génération.",useOidSecurityFilter:"Filtrez les résultats de recherche en fonction de l'OID de l'utilisateur authentifié.",useGroupsSecurityFilter:"Filtrez les résultats de recherche en fonction des groupes de l'utilisateur authentifié."},Wr={pageTitle:Tr,headerTitle:kr,chat:Ir,qa:Lr,login:Ar,logout:Nr,clearChat:Pr,history:Fr,upload:Er,developerSettings:Rr,chatEmptyStateTitle:Dr,chatEmptyStateSubtitle:Mr,defaultExamples:$r,askTitle:Br,gpt4vExamples:zr,generatingAnswer:Or,citationWithColon:qr,followupQuestions:Ur,tooltips:Gr,headerTexts:Vr,labels:Hr,helpTexts:Qr},Ke={en:{name:"English",locale:"en-US"},es:{name:"Español",locale:"es-ES"},fr:{name:"Français",locale:"fr-FR"},ja:{name:"日本語",locale:"ja-JP"}};cs.use(ln).use(cn).use(dn).init({resources:{en:{translation:Fo},es:{translation:sr},fr:{translation:Wr},ja:{translation:wr}},fallbackLng:"en",supportedLngs:Object.keys(Ke),debug:!1,interpolation:{escapeValue:!1}});const Kr=window.speechSynthesis||window.webkitSpeechSynthesis;let ie=null;try{ie=Kr}catch{console.error("SpeechSynthesis is not supported")}const Jr=function(s,t="en-US"){if(ie){const n=new SpeechSynthesisUtterance(s);n.lang=t,n.volume=1,n.rate=1,n.pitch=1;let r=ie.getVoices().filter(a=>a.lang===t)[0];return r||(r=ie.getVoices().filter(a=>a.lang==="en-US")[0]),n.voice=r,n}},Yr=({answer:s})=>{const{t,i18n:n}=A(),r=n.language;let a=Ke[r]?.locale;a||(a="en-US");const[i,d]=o.useState(!1),c=p=>{if(ie!=null){if(i){ie.cancel(),d(!1);return}const x=Jr(p,a);if(!x)return;ie.speak(x),x.onstart=()=>{d(!0)},x.onend=()=>{d(!1)}}},u=i?"red":"black";return e.jsx(te,{style:{color:u},iconProps:{iconName:"Volume3"},title:t("tooltips.speakAnswer"),ariaLabel:t("tooltips.speakAnswer"),onClick:()=>c(s),disabled:!ie})},Xr=({answer:s,speechConfig:t,index:n,isStreaming:r})=>{const[a,i]=o.useState(!1),[d,c]=o.useState(!1),{t:u}=A(),p=async L=>{t.audio.src=L,await t.audio.play().then(()=>{t.audio.onended=()=>{t.setIsPlaying(!1),c(!1)},t.setIsPlaying(!0),c(!0)}).catch(()=>{alert("Failed to play speech output."),console.error("Failed to play speech output."),t.setIsPlaying(!1),c(!1)})},x=async L=>{if(t.isPlaying){t.audio.pause(),t.audio.currentTime=0,t.setIsPlaying(!1),c(!1);return}if(t.speechUrls[n]){p(t.speechUrls[n]);return}i(!0),await Qa(L).then(async T=>{if(!T){alert("Speech output is not available."),console.error("Speech output is not available.");return}i(!1),t.setSpeechUrls(t.speechUrls.map((b,j)=>j===n?T:b)),p(T)})},f=d?"red":"black";return a?e.jsx(te,{style:{color:f},iconProps:{iconName:"Sync"},title:"Loading speech",ariaLabel:"Loading speech",disabled:!0}):e.jsxs(e.Fragment,{children:[e.jsx(te,{iconProps:{iconName:"Sync"},ariaHidden:!0,disabled:!0,style:{display:"none"}}),e.jsx(te,{style:{color:f},iconProps:{iconName:"Volume3"},title:u("tooltips.speakAnswer"),ariaLabel:u("tooltips.speakAnswer"),onClick:()=>x(s),disabled:r})]})},ns=({answer:s,index:t,speechConfig:n,isSelected:r,isStreaming:a,onCitationClicked:i,onMindmapClicked:d,onThoughtProcessClicked:c,onSupportingContentClicked:u,onFollowupQuestionClicked:p,showFollowupQuestions:x,showSpeechOutputAzure:f,showSpeechOutputBrowser:L})=>{const T=s.context?.followup_questions,b=s.message.content,j=o.useMemo(()=>co(b,a,i),[s]),{t:m}=A(),v=ds.sanitize(j.answerHtml);return e.jsxs(R,{className:`${G.answerContainer} ${r&&G.selected}`,verticalAlign:"space-between",children:[e.jsx(R.Item,{children:e.jsxs(R,{horizontal:!0,horizontalAlign:"space-between",children:[e.jsx(js,{}),e.jsxs("div",{children:[e.jsx(te,{style:{color:"black"},iconProps:{iconName:"Lightbulb"},title:m("tooltips.showThoughtProcess"),ariaLabel:m("tooltips.showThoughtProcess"),onClick:()=>c(),disabled:!s.context.thoughts?.length}),e.jsx(te,{style:{color:"black"},iconProps:{iconName:"Lightbulb"},title:m("tooltips.showThoughtProcess"),ariaLabel:m("tooltips.showThoughtProcess"),onClick:()=>c(),disabled:!s.context.thoughts?.length}),e.jsx(te,{style:{color:"black"},iconProps:{iconName:"ClipboardList"},title:m("tooltips.showSupportingContent"),ariaLabel:m("tooltips.showSupportingContent"),onClick:()=>u(),disabled:!s.context.data_points}),f&&e.jsx(Xr,{answer:v,index:t,speechConfig:n,isStreaming:a}),L&&e.jsx(Yr,{answer:v})]})]})}),e.jsx(R.Item,{grow:!0,children:e.jsx("div",{className:G.answerText,children:e.jsx(us,{children:v,rehypePlugins:[un],remarkPlugins:[ps]})})}),!!j.citations.length&&e.jsx(R.Item,{children:e.jsxs(R,{horizontal:!0,wrap:!0,tokens:{childrenGap:5},children:[e.jsx("span",{className:G.citationLearnMore,children:m("citationWithColon")}),j.citations.map((k,I)=>{const D=bs(k);return e.jsx("a",{className:G.citation,title:k,onClick:()=>i(D),children:`${++I}. ${k}`},I)})]})}),!!T?.length&&x&&p&&e.jsx(R.Item,{children:e.jsxs(R,{horizontal:!0,wrap:!0,className:`${j.citations.length?G.followupQuestionsList:""}`,tokens:{childrenGap:6},children:[e.jsx("span",{className:G.followupQuestionLearnMore,children:m("followupQuestions")}),T.map((k,I)=>e.jsx("a",{className:G.followupQuestion,title:k,onClick:()=>p(k),children:`${k}`},I))]})})]})},Zr=()=>{const{t:s,i18n:t}=A(),n=pn({from:{opacity:0},to:{opacity:1}});return e.jsx(hn.div,{style:{...n},children:e.jsxs(R,{className:G.answerContainer,verticalAlign:"space-between",children:[e.jsx(js,{}),e.jsx(R.Item,{grow:!0,children:e.jsxs("p",{className:G.answerText,children:[s("generatingAnswer"),e.jsx("span",{className:G.loadingdots})]})})]})})},ei=({error:s,onRetry:t})=>e.jsxs(R,{className:G.answerContainer,verticalAlign:"space-between",children:[e.jsx(Wn,{"aria-hidden":"true","aria-label":"Error icon",primaryFill:"red"}),e.jsx(R.Item,{grow:!0,children:e.jsx("p",{className:G.answerText,children:s})}),e.jsx(Pn,{className:G.retryButton,onClick:t,text:"Retry"})]}),ti="_questionInputContainer_in2nn_1",si="_questionInputTextArea_in2nn_23",ni="_questionInputButtonsContainer_in2nn_33",ze={questionInputContainer:ti,questionInputTextArea:si,questionInputButtonsContainer:ni},ai=()=>{const{i18n:s}=A(),t=s.language;let n=Ke[t]?.locale;n||(n="en-US");const r=window.SpeechRecognition||window.webkitSpeechRecognition;let a=null;try{a=new r,a!=null&&(a.lang=n,a.interimResults=!0)}catch{console.error("SpeechRecognition not supported"),a=null}return a},oi=({updateQuestion:s})=>{let t=ai();const{t:n}=A(),[r,a]=o.useState(!1),i=()=>{if(t==null){console.error("SpeechRecognition not supported");return}t.onresult=c=>{let u="";for(const p of c.results)u+=p[0].transcript;s(u)},t.onend=()=>{a(!1)},t.onerror=c=>{t&&(t.stop(),c.error=="no-speech"?alert("No speech was detected. Please check your system audio settings and try again."):c.error=="language-not-supported"?alert(`Speech recognition error detected: ${c.error}. The speech recognition input functionality does not yet work on all browsers, like Edge in Mac OS X with ARM chips. Try another browser/OS.`):alert(`Speech recognition error detected: ${c.error}.`))},a(!0),t.start()},d=()=>{if(t==null){console.error("SpeechRecognition not supported");return}t.stop(),a(!1)};return t==null?e.jsx(e.Fragment,{}):e.jsxs(e.Fragment,{children:[!r&&e.jsx("div",{className:ze.questionInputButtonsContainer,children:e.jsx(ut,{content:n("tooltips.askWithVoice"),relationship:"label",children:e.jsx(ge,{size:"large",icon:e.jsx(ts,{primaryFill:"rgba(115, 118, 225, 1)"}),onClick:i})})}),r&&e.jsx("div",{className:ze.questionInputButtonsContainer,children:e.jsx(ut,{content:n("tooltips.stopRecording"),relationship:"label",children:e.jsx(ge,{size:"large",icon:e.jsx(ts,{primaryFill:"rgba(250, 0, 0, 0.7)"}),disabled:!r,onClick:d})})})]})},ri=({onSend:s,disabled:t,placeholder:n,clearOnSend:r,initQuestion:a,showSpeechInput:i})=>{const[d,c]=o.useState(""),{loggedIn:u}=o.useContext(je),{t:p}=A(),[x,f]=o.useState(!1);o.useEffect(()=>{a&&c(a)},[a]);const L=()=>{t||!d.trim()||(s(d),r&&c(""))},T=I=>{x||I.key==="Enter"&&!I.shiftKey&&(I.preventDefault(),L())},b=()=>{f(!0)},j=()=>{f(!1)},m=(I,D)=>{D?D.length<=1e3&&c(D):c("")},v=ss&&!u,k=t||!d.trim()||ss;return v&&(n="Please login to continue..."),e.jsxs(R,{horizontal:!0,className:ze.questionInputContainer,children:[e.jsx(se,{className:ze.questionInputTextArea,disabled:v,placeholder:n,multiline:!0,resizable:!1,borderless:!0,value:d,onChange:m,onKeyDown:T,onCompositionStart:b,onCompositionEnd:j}),e.jsx("div",{className:ze.questionInputButtonsContainer,children:e.jsx(ut,{content:p("tooltips.submitQuestion"),relationship:"label",children:e.jsx(ge,{size:"large",icon:e.jsx(Kn,{primaryFill:"rgba(115, 118, 225, 1)"}),disabled:k,onClick:L})})}),i&&e.jsx(oi,{updateQuestion:c})]})},ii="_examplesNavList_1qj97_1",li="_example_1qj97_1",ci="_exampleText_1qj97_57",ht={examplesNavList:ii,example:li,exampleText:ci},di=({text:s,value:t,onClick:n})=>e.jsx("div",{className:ht.example,onClick:()=>n(t),children:e.jsx("p",{className:ht.exampleText,children:s})}),ui=({onExampleClicked:s,useGPT4V:t})=>{const{t:n}=A(),r=[n("defaultExamples.1"),n("defaultExamples.2"),n("defaultExamples.3")],a=[n("gpt4vExamples.1"),n("gpt4vExamples.2"),n("gpt4vExamples.3")];return e.jsx("ul",{className:ht.examplesNavList,children:(t?a:r).map((i,d)=>e.jsx("li",{children:e.jsx(di,{text:i,value:i,onClick:s})},d))})},pi="_container_1mznt_1",hi="_message_1mznt_17",as={container:pi,message:hi},Qe=({message:s})=>e.jsx("div",{className:as.container,children:e.jsx("div",{className:as.message,children:s})}),os={childrenGap:4,maxWidth:300},mi={root:{padding:20}},gi={root:{marginBottom:-3}},xi={iconName:"Info"},$=s=>{const[t,{toggle:n}]=Fn(!1),r=y("description"),a=y("iconButton"),{t:i}=A();return e.jsxs(e.Fragment,{children:[e.jsxs(R,{horizontal:!0,verticalAlign:"center",tokens:os,children:[e.jsx("label",{id:s.labelId,htmlFor:s.fieldId,children:s.label}),e.jsx(te,{id:a,iconProps:xi,title:i("tooltips.info"),ariaLabel:i("tooltips.info"),onClick:n,styles:gi})]}),t&&e.jsx(ms,{target:"#"+a,setInitialFocus:!0,onDismiss:n,ariaDescribedBy:r,role:"alertdialog",children:e.jsxs(R,{tokens:os,horizontalAlign:"start",styles:mi,children:[e.jsx("span",{id:r,children:s.helpText}),e.jsx(qe,{onClick:n,children:i("labels.closeButton")})]})})]})},fi="_thoughtProcess_j4orz_1",bi="_tList_j4orz_15",yi="_tListItem_j4orz_27",Si="_tStep_j4orz_79",vi="_tCodeBlock_j4orz_93",ji="_tProp_j4orz_101",_i="_citationImg_j4orz_119",ve={thoughtProcess:fi,tList:bi,tListItem:yi,tStep:Si,tCodeBlock:vi,tProp:ji,citationImg:_i};function Ci(s){const t=s.split(": "),n=t[0],r=ds.sanitize(t.slice(1).join(": "));return{title:n,content:r}}const wi="_supportingContentNavList_2higk_1",Ti="_supportingContentItem_2higk_17",ki="_supportingContentItemHeader_2higk_45",Ii="_supportingContentItemText_2higk_53",Li="_supportingContentItemImage_2higk_63",De={supportingContentNavList:wi,supportingContentItem:Ti,supportingContentItemHeader:ki,supportingContentItemText:Ii,supportingContentItemImage:Li},Ai=({supportingContent:s})=>{const t=Array.isArray(s)?s:s.text,n=Array.isArray(s)?[]:s?.images;return e.jsxs("ul",{className:De.supportingContentNavList,children:[t.map((r,a)=>{const i=Ci(r);return e.jsxs("li",{className:De.supportingContentItem,children:[e.jsx("h4",{className:De.supportingContentItemHeader,children:i.title}),e.jsx("p",{className:De.supportingContentItemText,dangerouslySetInnerHTML:{__html:i.content}})]},a)}),n?.map((r,a)=>e.jsx("img",{className:De.supportingContentItemImage,src:r.url},a))]})};var ee=(s=>(s.ThoughtProcessTab="thoughtProcess",s.SupportingContentTab="supportingContent",s.CitationTab="citation",s))(ee||{});hs.registerLanguage("json",mn);const Ni=({thoughts:s})=>e.jsx("ul",{className:ve.tList,children:s.map((t,n)=>e.jsxs("li",{className:ve.tListItem,children:[e.jsx("div",{className:ve.tStep,children:t.title}),e.jsx(R,{horizontal:!0,tokens:{childrenGap:5},children:t.props&&(Object.keys(t.props)||[]).map(r=>e.jsxs("span",{className:ve.tProp,children:[r,": ",JSON.stringify(t.props?.[r])]}))}),Array.isArray(t.description)?e.jsx(hs,{language:"json",wrapLongLines:!0,className:ve.tCodeBlock,style:gn,children:JSON.stringify(t.description,null,2)}):e.jsx("div",{children:t.description})]},n))}),Pi="_downloadButton_8bi8u_1",Fi="_markdownViewer_8bi8u_11",Ei="_loading_8bi8u_29",Ri="_error_8bi8u_41",Di="_markdown_8bi8u_11",he={downloadButton:Pi,markdownViewer:Fi,loading:Ei,error:Ri,markdown:Di},Mi=({src:s})=>{const[t,n]=o.useState(""),[r,a]=o.useState(!0),[i,d]=o.useState(null),{t:c}=A(),u=p=>{const x=/\[.*?\]\(#.*?\)/g;return p.replace(x,"")};return o.useEffect(()=>{(async()=>{try{const x=await fetch(s);if(!x.ok)throw new Error("Failed loading markdown file.");let f=await x.text();f=u(f),n(f)}catch(x){d(x)}finally{a(!1)}})()},[s]),e.jsx("div",{children:r?e.jsx("div",{className:`${he.loading} ${he.markdownViewer}`,children:e.jsx(En,{size:Rn.large,label:"Loading file"})}):i?e.jsx("div",{className:`${he.error} ${he.markdownViewer}`,children:e.jsxs(Dn,{messageBarType:Mn.error,isMultiline:!1,children:[i.message,e.jsx($n,{href:s,download:!0,children:"Download the file"})]})}):e.jsxs("div",{children:[e.jsx(te,{className:he.downloadButton,style:{color:"black"},iconProps:{iconName:"Save"},title:c("tooltips.save"),ariaLabel:c("tooltips.save"),href:s,download:!0}),e.jsx(us,{children:t,remarkPlugins:[ps],className:`${he.markdown} ${he.markdownViewer}`})]})})},dt={disabled:!0,style:{color:"grey"}},$i=({answer:s,activeTab:t,activeCitation:n,citationHeight:r,className:a,onActiveTabChanged:i})=>{const d=!s.context.thoughts,c=!s.context.data_points,u=!n,[p,x]=o.useState(""),[f,L]=o.useState(""),T=le?_e().instance:void 0,{t:b}=A(),j=async()=>{const v=T?await ce(T):void 0;if(n){const k=n.indexOf("#")?n.split("#")[1]:"",I=await fetch(n,{method:"GET",headers:await Ce(v)});console.log(I),L(I.url);const D=await I.blob();let K=URL.createObjectURL(D);k&&(K+="#"+k),x(K)}};o.useEffect(()=>{j()},[]);const m=()=>{if(!n)return null;switch(n.split(".").pop()?.toLowerCase()){case"png":return e.jsx("img",{src:p,className:ve.citationImg,alt:"Citation Image"});case"md":return e.jsx(Mi,{src:n});case"docx":return e.jsxs("iframe",{title:"Citation",src:`https://view.officeapps.live.com/op/view.aspx?src=${f}`,width:"100%",height:r,children:["This is an embedded"," ",e.jsx("a",{target:"_blank",href:"http://office.com",children:"Microsoft Office"})," ","document, powered by"," ",e.jsx("a",{target:"_blank",href:"http://office.com/webapps",children:"Office Online"}),"."]});default:return e.jsx("iframe",{title:"Citation",src:p,width:"100%",height:r})}};return e.jsxs(Bn,{className:a,selectedKey:t,onLinkClick:v=>v&&i(v.props.itemKey),children:[e.jsx(lt,{itemKey:ee.ThoughtProcessTab,headerText:b("headerTexts.thoughtProcess"),headerButtonProps:d?dt:void 0,children:e.jsx(Ni,{thoughts:s.context.thoughts||[]})}),e.jsx(lt,{itemKey:ee.SupportingContentTab,headerText:b("headerTexts.supportingContent"),headerButtonProps:c?dt:void 0,children:e.jsx(Ai,{supportingContent:s.context.data_points})}),e.jsx(lt,{itemKey:ee.CitationTab,headerText:b("headerTexts.citation"),headerButtonProps:u?dt:void 0,children:m()})]})},Bi="_historyItem_18zik_1",zi="_historyItemButton_18zik_27",Oi="_historyItemTitle_18zik_47",qi="_deleteIcon_18zik_55",Ui="_deleteButton_18zik_65",Gi="_modalOverlay_18zik_105",Vi="_modalContent_18zik_131",Hi="_modalTitle_18zik_153",Qi="_modalDescription_18zik_167",Wi="_modalActions_18zik_177",Ki="_modalCancelButton_18zik_191",Ji="_modalConfirmButton_18zik_193",W={historyItem:Bi,historyItemButton:zi,historyItemTitle:Oi,deleteIcon:qi,deleteButton:Ui,modalOverlay:Gi,modalContent:Vi,modalTitle:Hi,modalDescription:Qi,modalActions:Wi,modalCancelButton:Ki,modalConfirmButton:Ji};function Yi({item:s,onSelect:t,onDelete:n}){const[r,a]=o.useState(!1),i=o.useCallback(()=>{a(!1),n(s.id)},[s.id,n]);return e.jsxs("div",{className:W.historyItem,children:[e.jsx("button",{onClick:()=>t(s.id),className:W.historyItemButton,"aria-label":`Select ${s.title}`,children:e.jsx("div",{className:W.historyItemTitle,children:s.title})}),e.jsx("button",{onClick:()=>a(!0),className:W.deleteButton,"aria-label":"delete this chat history",children:e.jsx(Ue,{className:W.deleteIcon})}),e.jsx(Xi,{isOpen:r,onClose:()=>a(!1),onConfirm:i})]})}function Xi({isOpen:s,onClose:t,onConfirm:n}){if(!s)return null;const{t:r}=A();return e.jsx("div",{className:W.modalOverlay,children:e.jsxs("div",{className:W.modalContent,children:[e.jsx("h2",{className:W.modalTitle,children:r("history.deleteModalTitle")}),e.jsx("p",{className:W.modalDescription,children:r("history.deleteModalDescription")}),e.jsxs("div",{className:W.modalActions,children:[e.jsx(qe,{onClick:t,className:W.modalCancelButton,children:r("history.cancelLabel")}),e.jsx(qe,{onClick:n,className:W.modalConfirmButton,children:r("history.deleteLabel")})]})]})})}var xe=(s=>(s.None="none",s.IndexedDB="indexedDB",s))(xe||{});class Zi{getProviderName=()=>xe.None;resetContinuationToken(){}async getNextItems(t){return[]}async addItem(t,n){}async getItem(t){return null}async deleteItem(t){}}class el{getProviderName=()=>xe.IndexedDB;dbName;storeName;dbPromise=null;cursorKey;isCusorEnd=!1;constructor(t,n){this.dbName=t,this.storeName=n,this.cursorKey=void 0,this.isCusorEnd=!1}async init(){const t=this.storeName;return this.dbPromise||(this.dbPromise=xn(this.dbName,1,{upgrade(n){n.objectStoreNames.contains(t)||n.createObjectStore(t,{keyPath:"id"}).createIndex("timestamp","timestamp")}})),this.dbPromise}resetContinuationToken(){this.cursorKey=void 0,this.isCusorEnd=!1}async getNextItems(t){const i=(await this.init()).transaction(this.storeName,"readonly").objectStore(this.storeName).index("timestamp");if(this.isCusorEnd)return[];let d=this.cursorKey?await i.openCursor(IDBKeyRange.upperBound(this.cursorKey),"prev"):await i.openCursor(null,"prev");if(!d)return this.isCusorEnd=!0,[];const c=[];for(let u=0;u<t&&d;u++)c.push(d.value),d=await d.continue();return d||(this.isCusorEnd=!0),this.cursorKey=d?.key,c}async addItem(t,n){const r=new Date().getTime(),i=(await this.init()).transaction(this.storeName,"readwrite"),d=await i.objectStore(this.storeName).get(t);if(d)await i.objectStore(this.storeName).put({...d,id:t,timestamp:r,answers:n});else{const c=n[0][0].length>50?n[0][0].substring(0,50)+"...":n[0][0];await i.objectStore(this.storeName).add({id:t,title:c,timestamp:r,answers:n})}await i.done}async getItem(t){const a=await(await this.init()).transaction(this.storeName,"readonly").objectStore(this.storeName).get(t);return a?a.answers:null}async deleteItem(t){await(await this.init()).delete(this.storeName,t)}}const _s=s=>o.useMemo(()=>{switch(s){case xe.IndexedDB:return new el("chat-database","chat-history");case xe.None:default:return new Zi}},[s]),tl="_group_1kzbu_1",sl="_groupLabel_1kzbu_7",nl="_footer_1kzbu_21",rs={group:tl,groupLabel:sl,footer:nl},al=20,ol=({provider:s,isOpen:t,notify:n,onClose:r,onChatSelected:a})=>{const i=_s(s),[d,c]=o.useState([]),[u,p]=o.useState(!1),[x,f]=o.useState(!1);o.useEffect(()=>{t&&n&&(c([]),i.resetContinuationToken(),f(!0))},[t,n]);const L=async()=>{p(()=>!0);const v=await i.getNextItems(al);v.length===0&&f(!1),c(k=>[...k,...v]),p(()=>!1)},T=async v=>{const k=await i.getItem(v);k&&a(k)},b=async v=>{await i.deleteItem(v),c(k=>k.filter(I=>I.id!==v))},j=o.useMemo(()=>rl(d),[d]),{t:m}=A();return e.jsx(gs,{type:zn.customNear,style:{padding:"0px"},headerText:m("history.chatHistory"),customWidth:"300px",isBlocking:!1,isOpen:t,onDismiss:()=>r(),onDismissed:()=>{c([]),f(!0),i.resetContinuationToken()},children:e.jsxs("div",{children:[Object.entries(j).map(([v,k])=>e.jsxs("div",{className:rs.group,children:[e.jsx("p",{className:rs.groupLabel,children:m(v)}),k.map(I=>e.jsx(Yi,{item:I,onSelect:T,onDelete:b},I.id))]},v)),d.length===0&&e.jsx("p",{children:m("history.noHistory")}),x&&!u&&e.jsx(il,{func:L})]})})};function rl(s){const t=new Date;t.setHours(0,0,0,0);const n=new Date(t);n.setDate(n.getDate()-1);const r=new Date(t);r.setDate(r.getDate()-7);const a=new Date(t);return a.setDate(a.getDate()-30),s.reduce((i,d)=>{const c=new Date(d.timestamp);let u;return c>=t?u="history.today":c>=n?u="history.yesterday":c>=r?u="history.last7days":c>=a?u="history.last30days":u=c.toLocaleDateString(void 0,{year:"numeric",month:"long"}),i[u]||(i[u]=[]),i[u].push(d),i},{})}const il=({func:s})=>{const t=o.useRef(null);return o.useEffect(()=>{const n=new IntersectionObserver(r=>{r.forEach(a=>{a.isIntersecting&&t.current&&s()})},{root:null,threshold:0});return t.current&&n.observe(t.current),()=>{t.current&&n.unobserve(t.current)}},[]),e.jsx("button",{ref:t,onClick:s})},ll="_container_nwwgz_1",cl={container:ll},dl=({className:s,onClick:t})=>{const{t:n}=A();return e.jsx("div",{className:`${cl.container} ${s??""}`,children:e.jsx(ge,{icon:e.jsx(Jn,{}),onClick:t,children:n("developerSettings")})})},ul="_container_nwwgz_1",pl={container:ul},hl=({className:s,disabled:t,onClick:n})=>{const{t:r,i18n:a}=A();return e.jsx("div",{className:`${pl.container} ${s??""}`,children:e.jsx(ge,{icon:e.jsx(Ue,{}),disabled:t,onClick:n,children:r("clearChat")})})},ml="_container_i0vu0_1",gl="_callout_i0vu0_17",xl="_list_i0vu0_27",fl="_item_i0vu0_39",bl="_uploadContainer_i0vu0_55",Me={container:ml,callout:gl,list:xl,item:fl,uploadContainer:bl},yl=({className:s,disabled:t})=>{const[n,r]=o.useState(!1),[a,i]=o.useState(!1),[d,c]=o.useState(!0),[u,p]=o.useState({}),[x,f]=o.useState(),[L,T]=o.useState(),[b,j]=o.useState([]),{t:m}=A();if(!le)throw new Error("The UploadFile component requires useLogin to be true");const v=_e().instance,k=async()=>{r(!n);try{const C=await ce(v);if(!C)throw new Error("No authentication token available");I(C)}catch(C){console.error(C),c(!1)}},I=async C=>{vs(C).then(F=>{c(!1),p({}),j(F)})},D=async C=>{p({...u,[C]:"pending"});try{const F=await ce(v);if(!F)throw new Error("No authentication token available");await Ss(C,F),p({...u,[C]:"success"}),I(F)}catch(F){p({...u,[C]:"error"}),console.error(F)}},K=async C=>{if(C.preventDefault(),!C.target.files||C.target.files.length===0)return;i(!0);const F=C.target.files[0],be=new FormData;be.append("file",F);try{const B=await ce(v);if(console.log("Token for upload:",B),console.log("Uploading file:",F.name),!B)throw new Error("No authentication token available");const Z=await ys(be,B);console.log("Upload response:",Z),f(Z),i(!1),T(void 0),I(B)}catch(B){console.error("File upload failed:",B),i(!1),T(B.message||m("upload.uploadedFileError"))}};return e.jsx("div",{className:`${Me.container} ${s??""}`,children:e.jsxs("div",{children:[e.jsx(ge,{id:"calloutButton",icon:e.jsx(Yn,{}),disabled:t,onClick:k,children:m("upload.manageFileUploads")}),n&&e.jsxs(ms,{role:"dialog",gapSpace:0,className:Me.callout,target:"#calloutButton",onDismiss:()=>r(!1),setInitialFocus:!0,children:[e.jsx("form",{encType:"multipart/form-data",children:e.jsxs("div",{children:[e.jsx(xs,{children:m("upload.fileLabel")}),e.jsx("input",{accept:".txt, .md, .json, .png, .jpg, .jpeg, .bmp, .heic, .tiff, .pdf, .docx, .xlsx, .pptx, .html",className:Me.chooseFiles,type:"file",onChange:K})]})}),a&&e.jsx(Re,{children:m("upload.uploadingFiles")}),!a&&L&&e.jsx(Re,{children:L}),!a&&x&&e.jsx(Re,{children:x.message}),e.jsx("h3",{children:m("upload.uploadedFilesLabel")}),d&&e.jsx(Re,{children:m("upload.loading")}),!d&&b.length===0&&e.jsx(Re,{children:m("upload.noFilesUploaded")}),b.map((C,F)=>e.jsxs("div",{className:Me.list,children:[e.jsx("div",{className:Me.item,children:C}),e.jsxs(ge,{icon:e.jsx(Ue,{}),onClick:()=>D(C),disabled:u[C]==="pending"||u[C]==="success",children:[!u[C]&&m("upload.deleteFile"),u[C]=="pending"&&m("upload.deletingFile"),u[C]=="error"&&m("upload.errorDeleting"),u[C]=="success"&&m("upload.fileDeleted")]})]},F))]})]})})},Sl="_container_17evt_1",vl={container:Sl},jl=({updateRetrievalMode:s,updateVectorFields:t,showImageOptions:n,defaultRetrievalMode:r})=>{const[a,i]=o.useState(U.Hybrid),[d,c]=o.useState(Q.Both),u=(j,m)=>{i(m?.data||U.Hybrid),s(m?.data||U.Hybrid)},p=(j,m)=>{c(m?.key),t([m?.key])};o.useEffect(()=>{t(n?[Q.Embedding,Q.ImageEmbedding]:[Q.Embedding])},[n]);const x=y("retrievalMode"),f=y("retrievalModeField"),L=y("vectorFields"),T=y("vectorFieldsField"),{t:b}=A();return e.jsxs(R,{className:vl.container,tokens:{childrenGap:10},children:[e.jsx(Oe,{id:f,label:b("labels.retrievalMode.label"),selectedKey:r.toString(),options:[{key:"hybrid",text:b("labels.retrievalMode.options.hybrid"),selected:a==U.Hybrid,data:U.Hybrid},{key:"vectors",text:b("labels.retrievalMode.options.vectors"),selected:a==U.Vectors,data:U.Vectors},{key:"text",text:b("labels.retrievalMode.options.texts"),selected:a==U.Text,data:U.Text}],required:!0,onChange:u,"aria-labelledby":x,onRenderLabel:j=>e.jsx($,{labelId:x,fieldId:f,helpText:b("helpTexts.retrievalMode"),label:j?.label})}),n&&[U.Vectors,U.Hybrid].includes(a)&&e.jsx(Oe,{id:T,label:b("labels.vector.label"),options:[{key:Q.Embedding,text:b("labels.vector.options.embedding"),selected:d===Q.Embedding},{key:Q.ImageEmbedding,text:b("labels.vector.options.imageEmbedding"),selected:d===Q.ImageEmbedding},{key:Q.Both,text:b("labels.vector.options.both"),selected:d===Q.Both}],onChange:p,"aria-labelledby":L,onRenderLabel:j=>e.jsx($,{labelId:L,fieldId:T,helpText:b("helpTexts.vectorFields"),label:j?.label})})]})},_l=()=>{const{instance:s}=_e();s.getActiveAccount();const[t,n]=o.useState(void 0);o.useEffect(()=>{(async()=>{n(await Ga(s))})()},[]);const r=c=>typeof c=="string"?c:JSON.stringify(c),i=(c=>Object.keys(c??{}).map(u=>{let p=u;try{const f=new URL(u).pathname.split("/");u=f[f.length-1]}catch{}return{name:u,value:r((c??{})[p])}}))(t),d=[es({columnId:"name",compare:(c,u)=>c.name.localeCompare(u.name),renderHeaderCell:()=>"Name",renderCell:c=>c.name}),es({columnId:"value",compare:(c,u)=>c.value.localeCompare(u.value),renderHeaderCell:()=>"Value",renderCell:c=>c.value})];return e.jsxs("div",{children:[e.jsx(xs,{children:"ID Token Claims"}),e.jsxs(On,{items:i,columns:d,sortable:!0,getRowId:c=>c.name,children:[e.jsx(qn,{children:e.jsx(Zt,{children:({renderHeaderCell:c})=>e.jsx(Un,{children:c()})})}),e.jsx(Gn,{children:({item:c,rowId:u})=>e.jsx(Zt,{children:({renderCell:p})=>e.jsx(Vn,{children:p(c)})},u)})]})]})},Cl="_container_17evt_1",wl={container:Cl},Tl=({updateGPT4VInputs:s,updateUseGPT4V:t,isUseGPT4V:n,gpt4vInputs:r})=>{const[a,i]=o.useState(n),[d,c]=o.useState(r||re.TextAndImages),u=(j,m)=>{t(!!m),i(!!m)},p=(j,m)=>{if(m){const v=m.key;s(v||re.TextAndImages),v&&c(v)}};o.useEffect(()=>{a&&s(re.TextAndImages)},[a]);const x=y("useGPT4V"),f=y("useGPT4VField"),L=y("gpt4VInput"),T=y("gpt4VInputField"),{t:b}=A();return e.jsxs(R,{className:wl.container,tokens:{childrenGap:10},children:[e.jsx(me,{id:f,checked:a,label:b("labels.useGPT4V"),onChange:u,"aria-labelledby":x,onRenderLabel:j=>e.jsx($,{labelId:x,fieldId:f,helpText:b("helpTexts.useGPT4Vision"),label:j?.label})}),a&&e.jsx(Oe,{id:T,selectedKey:d,label:b("labels.gpt4VInput.label"),options:[{key:re.TextAndImages,text:b("labels.gpt4VInput.options.textAndImages")},{text:b("labels.gpt4VInput.options.images"),key:re.Images},{text:b("labels.gpt4VInput.options.texts"),key:re.Texts}],required:!0,onChange:p,"aria-labelledby":L,onRenderLabel:j=>e.jsx($,{labelId:L,fieldId:T,helpText:b("helpTexts.gpt4VisionInputs"),label:j?.label})})]})},kl="_languagePicker_wrwd4_1",Il="_languagePickerIcon_wrwd4_43",is={languagePicker:kl,languagePickerIcon:Il},Ll=({onLanguageChange:s})=>{const{i18n:t}=A(),n=(i,d)=>{s(d?.data||t.language)},r=y("languagePicker"),{t:a}=A();return e.jsxs("div",{className:is.languagePicker,children:[e.jsx(Xn,{className:is.languagePickerIcon}),e.jsx(Oe,{id:r,selectedKey:t.language,options:Object.entries(Ke).map(([i,d])=>({key:i,text:d.name,selected:i===t.language,data:i})),onChange:n,ariaLabel:a("labels.languagePicker")})]})},Al=fn({palette:{themePrimary:"#0078d4",themeLighterAlt:"#00060a",themeLighter:"#001828",themeLight:"#002d4e",themeTertiary:"#005a9d",themeSecondary:"#0086eb",themeDarkAlt:"#2294ed",themeDark:"#3fa5ef",themeDarker:"#70c0f3",neutralLighterAlt:"#2a2a2a",neutralLighter:"#323232",neutralLight:"#3c3c3c",neutralQuaternaryAlt:"#444444",neutralQuaternary:"#4a4a4a",neutralTertiaryAlt:"#6f6f6f",neutralTertiary:"#c8c8c8",neutralSecondary:"#d0d0d0",neutralPrimaryAlt:"#dadada",neutralPrimary:"#ffffff",neutralDark:"#f4f4f4",black:"#f8f8f8",white:"#1c1c1c"}}),Nl=()=>{const[s,t]=o.useState(!0),[n,r]=o.useState(!1),[a,i]=o.useState(!1),[d,c]=o.useState(""),[u,p]=o.useState(.3),[x,f]=o.useState(null),[L,T]=o.useState(0),[b,j]=o.useState(0),[m,v]=o.useState(3),[k,I]=o.useState(U.Hybrid),[D,K]=o.useState(!0),[C,F]=o.useState(!0),[be,B]=o.useState(!1),[Z,ye]=o.useState(""),[de,we]=o.useState(!1),[mt,Te]=o.useState([Q.Embedding]),[ke,Je]=o.useState(!1),[Ie,Ye]=o.useState(!1),[Ve,Xe]=o.useState(re.TextAndImages),[ue,Ze]=o.useState(!1),J=o.useRef(""),He=o.useRef(null),[ne,Se]=o.useState(!1),[pe,Le]=o.useState(!1),[g,S]=o.useState(),[z,V]=o.useState(),[Y,X]=o.useState(void 0),[ae,oe]=o.useState(0),[N,Ae]=o.useState([]),[gt,xt]=o.useState([]),[ft,et]=o.useState([]),[bt,Cs]=o.useState(!1),[yt,ws]=o.useState(!1),[Ts,ks]=o.useState(!1),[Is,Ls]=o.useState(!1),[As,Ns]=o.useState(!1),[Ps,Fs]=o.useState(!1),[St,Es]=o.useState(!1),[vt,Rs]=o.useState(!1),[jt,Ds]=o.useState(!1),Ms=o.useRef(new Audio).current,[$s,Bs]=o.useState(!1),_t={speechUrls:ft,setSpeechUrls:et,audio:Ms,isPlaying:$s,setIsPlaying:Bs},zs=async()=>{Va().then(l=>{Cs(l.showGPT4VOptions),K(l.showSemanticRankerOption),ws(l.showSemanticRankerOption),ks(l.showVectorOption),l.showVectorOption||I(U.Text),Ls(l.showUserUpload),Ns(l.showLanguagePicker),Fs(l.showSpeechInput),Es(l.showSpeechOutputBrowser),Rs(l.showSpeechOutputAzure),Ds(l.showChatHistoryBrowser)})},Os=async(l,h,H)=>{let Fe="",O={};const E=q=>new Promise(nn=>{setTimeout(()=>{Fe+=q;const an={...O,message:{content:Fe,role:O.message.role}};xt([...h,[l,an]]),nn(null)},33)});try{Le(!0);for await(const q of Sn(H))if(q.context&&q.context.data_points)q.message=q.delta,O=q;else if(q.delta&&q.delta.content)Se(!1),await E(q.delta.content);else if(q.context)O.context={...O.context,...q.context};else if(q.error)throw Error(q.error)}finally{Le(!1)}return{...O,message:{content:Fe,role:O.message.role}}},Ct=le?_e().instance:void 0,{loggedIn:tt}=o.useContext(je),st=jt?xe.IndexedDB:xe.None,nt=_s(st),Ne=async l=>{J.current=l,g&&S(void 0),Se(!0),V(void 0),X(void 0);const h=Ct?await ce(Ct):void 0;try{const Fe={messages:[...N.flatMap(E=>[{content:E[0],role:"user"},{content:E[1].message.content,role:"assistant"}]),{content:l,role:"user"}],context:{overrides:{prompt_template:d.length===0?void 0:d,exclude_category:Z.length===0?void 0:Z,top:m,temperature:u,minimum_reranker_score:L,minimum_search_score:b,retrieval_mode:k,semantic_ranker:D,semantic_captions:be,suggest_followup_questions:de,use_oid_security_filter:ke,use_groups_security_filter:Ie,vector_fields:mt,use_gpt4v:ue,gpt4v_input:Ve,language:Xt.language,...x!==null?{seed:x}:{}}},session_state:N.length?N[N.length-1][1].session_state:null},O=await Ha(Fe,C,h);if(!O.body)throw Error("No response body");if(O.status>299||!O.ok)throw Error(`Request failed with status ${O.status}`);if(C){const E=await Os(l,N,O.body);Ae([...N,[l,E]]),typeof E.session_state=="string"&&E.session_state!==""&&nt.addItem(E.session_state,[...N,[l,E]])}else{const E=await O.json();if(E.error)throw Error(E.error);Ae([...N,[l,E]]),typeof E.session_state=="string"&&E.session_state!==""&&nt.addItem(E.session_state,[...N,[l,E]])}et([...ft,null])}catch(H){S(H)}finally{Se(!1)}},qs=()=>{J.current="",g&&S(void 0),V(void 0),X(void 0),Ae([]),et([]),xt([]),Se(!1),Le(!1)};o.useEffect(()=>He.current?.scrollIntoView({behavior:"smooth"}),[ne]),o.useEffect(()=>He.current?.scrollIntoView({behavior:"auto"}),[gt]),o.useEffect(()=>{zs()},[]);const Us=(l,h)=>{c(h||"")},Gs=(l,h)=>{p(parseFloat(h||"0"))},Vs=(l,h)=>{f(parseInt(h||""))},Hs=(l,h)=>{j(parseFloat(h||"0"))},Qs=(l,h)=>{T(parseFloat(h||"0"))},Ws=(l,h)=>{v(parseInt(h||"3"))},Ks=(l,h)=>{K(!!h)},Js=(l,h)=>{B(!!h)},Ys=(l,h)=>{F(!!h)},Xs=(l,h)=>{ye(h||"")},Zs=(l,h)=>{we(!!h)},en=(l,h)=>{Je(!!h)},tn=(l,h)=>{Ye(!!h)},sn=l=>{Ne(l)},wt=(l,h)=>{z===l&&Y===ee.CitationTab&&ae===h?X(void 0):(V(l),X(ee.CitationTab)),oe(h)},Pe=(l,h)=>{X(Y===l&&ae===h?void 0:l),oe(h)},Tt=y("promptTemplate"),kt=y("promptTemplateField"),It=y("temperature"),Lt=y("temperatureField"),At=y("seed"),Nt=y("seedField"),Pt=y("searchScore"),Ft=y("searchScoreField"),Et=y("rerankerScore"),Rt=y("rerankerScoreField"),Dt=y("retrieveCount"),Mt=y("retrieveCountField"),$t=y("excludeCategory"),Bt=y("excludeCategoryField"),zt=y("semanticRanker"),Ot=y("semanticRankerField"),qt=y("semanticCaptions"),Ut=y("semanticCaptionsField"),Gt=y("suggestFollowupQuestions"),Vt=y("suggestFollowupQuestionsField"),Ht=y("useOidSecurityFilter"),Qt=y("useOidSecurityFilterField"),Wt=y("useGroupsSecurityFilter"),Kt=y("useGroupsSecurityFilterField"),Jt=y("shouldStream"),Yt=y("shouldStreamField"),{t:_,i18n:Xt}=A();return e.jsx(Hn,{theme:Al,children:e.jsxs("div",{style:{display:s?"flex":"block",justifyContent:"space-between"},children:[s?e.jsxs("div",{children:[e.jsx("button",{onClick:()=>t(!1),children:e.jsx(Be,{icon:bn})}),e.jsx(Ka,{provider:st,historyManager:nt,isOpen:a,notify:!pe&&!ne,onClose:()=>i(!1),onChatSelected:l=>{l.length!==0&&(Ae(l),J.current=l[l.length-1][0])}})]}):null,e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{className:w.commandsSplitContainer,children:[e.jsx("div",{children:s?null:e.jsx("button",{onClick:()=>t(!0),children:e.jsx(Be,{icon:yn})})}),e.jsxs("div",{className:w.commandsContainer,children:[e.jsx(hl,{className:w.commandButton,onClick:qs,disabled:!J.current||ne}),Is&&e.jsx(yl,{className:w.commandButton,disabled:!tt}),e.jsx(dl,{className:w.commandButton,onClick:()=>r(!n)})]})]}),e.jsxs("div",{className:w.chatRoot,style:{marginLeft:a?"300px":"0"},children:[e.jsxs("div",{className:w.chatContainer,children:[J.current?e.jsxs("div",{className:w.chatMessageStream,children:[pe&&gt.map((l,h)=>e.jsxs("div",{children:[e.jsx(Qe,{message:l[0]}),e.jsx("div",{className:w.chatMessageGpt,children:e.jsx(ns,{isStreaming:!0,answer:l[1],index:h,speechConfig:_t,isSelected:!1,onCitationClicked:H=>wt(H,h),onThoughtProcessClicked:()=>Pe(ee.ThoughtProcessTab,h),onSupportingContentClicked:()=>Pe(ee.SupportingContentTab,h),onFollowupQuestionClicked:H=>Ne(H),showFollowupQuestions:de&&N.length-1===h,showSpeechOutputAzure:vt,showSpeechOutputBrowser:St},h)})]},h)),!pe&&N.map((l,h)=>e.jsxs("div",{children:[e.jsx(Qe,{message:l[0]}),e.jsx("div",{className:w.chatMessageGpt,children:e.jsx(ns,{isStreaming:!1,answer:l[1],index:h,speechConfig:_t,isSelected:ae===h&&Y!==void 0,onCitationClicked:H=>wt(H,h),onThoughtProcessClicked:()=>Pe(ee.ThoughtProcessTab,h),onSupportingContentClicked:()=>Pe(ee.SupportingContentTab,h),onFollowupQuestionClicked:H=>Ne(H),showFollowupQuestions:de&&N.length-1===h,showSpeechOutputAzure:vt,showSpeechOutputBrowser:St},h)})]},h)),ne&&e.jsxs(e.Fragment,{children:[e.jsx(Qe,{message:J.current}),e.jsx("div",{className:w.chatMessageGptMinWidth,children:e.jsx(Zr,{})})]}),g?e.jsxs(e.Fragment,{children:[e.jsx(Qe,{message:J.current}),e.jsx("div",{className:w.chatMessageGptMinWidth,children:e.jsx(ei,{error:g.toString(),onRetry:()=>Ne(J.current)})})]}):null,e.jsx("div",{ref:He})]}):e.jsxs("div",{className:w.chatEmptyState,children:[e.jsx(Zn,{fontSize:"120px",primaryFill:"rgba(115, 118, 225, 1)","aria-hidden":"true"}),e.jsx("h1",{className:w.chatEmptyStateTitle,children:_("chatEmptyStateTitle")}),e.jsx("h2",{className:w.chatEmptyStateSubtitle,children:_("chatEmptyStateSubtitle")}),As&&e.jsx(Ll,{onLanguageChange:l=>Xt.changeLanguage(l)}),e.jsx(ui,{onExampleClicked:sn,useGPT4V:ue})]}),e.jsx("div",{className:w.chatInput,children:e.jsx(ri,{clearOnSend:!0,placeholder:_("defaultExamples.placeholder"),disabled:ne,onSend:l=>Ne(l),showSpeechInput:Ps})})]}),N.length>0&&Y&&e.jsx($i,{className:w.chatAnalysisPanel,activeCitation:z,onActiveTabChanged:l=>Pe(l,ae),citationHeight:"810px",answer:N[ae][1],activeTab:Y}),jt&&e.jsx(ol,{provider:st,isOpen:a,notify:!pe&&!ne,onClose:()=>i(!1),onChatSelected:l=>{l.length!==0&&(Ae(l),J.current=l[l.length-1][0])}}),e.jsxs(gs,{headerText:_("labels.headerText"),isOpen:n,isBlocking:!1,onDismiss:()=>r(!1),closeButtonAriaLabel:_("labels.closeButton"),onRenderFooterContent:()=>e.jsx(qe,{onClick:()=>r(!1),children:_("labels.closeButton")}),isFooterAtBottom:!0,children:[e.jsx(se,{id:kt,className:w.chatSettingsSeparator,defaultValue:d,label:_("labels.promptTemplate"),multiline:!0,autoAdjustHeight:!0,onChange:Us,"aria-labelledby":Tt,onRenderLabel:l=>e.jsx($,{labelId:Tt,fieldId:kt,helpText:_("helpTexts.promptTemplate"),label:l?.label})}),e.jsx(se,{id:Lt,className:w.chatSettingsSeparator,label:_("labels.temperature"),type:"number",min:0,max:1,step:.1,defaultValue:u.toString(),onChange:Gs,"aria-labelledby":It,onRenderLabel:l=>e.jsx($,{labelId:It,fieldId:Lt,helpText:_("helpTexts.temperature"),label:l?.label})}),e.jsx(se,{id:Nt,className:w.chatSettingsSeparator,label:_("labels.seed"),type:"text",defaultValue:x?.toString()||"",onChange:Vs,"aria-labelledby":At,onRenderLabel:l=>e.jsx($,{labelId:At,fieldId:Nt,helpText:_("helpTexts.seed"),label:l?.label})}),e.jsx(se,{id:Ft,className:w.chatSettingsSeparator,label:_("labels.minimumSearchScore"),type:"number",min:0,step:.01,defaultValue:b.toString(),onChange:Hs,"aria-labelledby":Pt,onRenderLabel:l=>e.jsx($,{labelId:Pt,fieldId:Ft,helpText:_("helpTexts.searchScore"),label:l?.label})}),yt&&e.jsx(se,{id:Rt,className:w.chatSettingsSeparator,label:_("labels.minimumRerankerScore"),type:"number",min:1,max:4,step:.1,defaultValue:L.toString(),onChange:Qs,"aria-labelledby":Et,onRenderLabel:l=>e.jsx($,{labelId:Et,fieldId:Rt,helpText:_("helpTexts.rerankerScore"),label:l?.label})}),e.jsx(se,{id:Mt,className:w.chatSettingsSeparator,label:_("labels.retrieveCount"),type:"number",min:1,max:50,defaultValue:m.toString(),onChange:Ws,"aria-labelledby":Dt,onRenderLabel:l=>e.jsx($,{labelId:Dt,fieldId:Mt,helpText:_("helpTexts.retrieveNumber"),label:l?.label})}),e.jsx(se,{id:Bt,className:w.chatSettingsSeparator,label:_("labels.excludeCategory"),defaultValue:Z,onChange:Xs,"aria-labelledby":$t,onRenderLabel:l=>e.jsx($,{labelId:$t,fieldId:Bt,helpText:_("helpTexts.excludeCategory"),label:l?.label})}),yt&&e.jsxs(e.Fragment,{children:[e.jsx(me,{id:Ot,className:w.chatSettingsSeparator,checked:D,label:_("labels.useSemanticRanker"),onChange:Ks,"aria-labelledby":zt,onRenderLabel:l=>e.jsx($,{labelId:zt,fieldId:Ot,helpText:_("helpTexts.useSemanticReranker"),label:l?.label})}),e.jsx(me,{id:Ut,className:w.chatSettingsSeparator,checked:be,label:_("labels.useSemanticCaptions"),onChange:Js,disabled:!D,"aria-labelledby":qt,onRenderLabel:l=>e.jsx($,{labelId:qt,fieldId:Ut,helpText:_("helpTexts.useSemanticCaptions"),label:l?.label})})]}),e.jsx(me,{id:Vt,className:w.chatSettingsSeparator,checked:de,label:_("labels.useSuggestFollowupQuestions"),onChange:Zs,"aria-labelledby":Gt,onRenderLabel:l=>e.jsx($,{labelId:Gt,fieldId:Vt,helpText:_("helpTexts.suggestFollowupQuestions"),label:l?.label})}),bt&&e.jsx(Tl,{gpt4vInputs:Ve,isUseGPT4V:ue,updateUseGPT4V:l=>{Ze(l)},updateGPT4VInputs:l=>Xe(l)}),Ts&&e.jsx(jl,{defaultRetrievalMode:k,showImageOptions:ue&&bt,updateVectorFields:l=>Te(l),updateRetrievalMode:l=>I(l)}),le&&e.jsxs(e.Fragment,{children:[e.jsx(me,{id:Qt,className:w.chatSettingsSeparator,checked:ke||$e,label:_("labels.useOidSecurityFilter"),disabled:!tt||$e,onChange:en,"aria-labelledby":Ht,onRenderLabel:l=>e.jsx($,{labelId:Ht,fieldId:Qt,helpText:_("helpTexts.useOidSecurityFilter"),label:l?.label})}),e.jsx(me,{id:Kt,className:w.chatSettingsSeparator,checked:Ie||$e,label:_("labels.useGroupsSecurityFilter"),disabled:!tt||$e,onChange:tn,"aria-labelledby":Wt,onRenderLabel:l=>e.jsx($,{labelId:Wt,fieldId:Kt,helpText:_("helpTexts.useGroupsSecurityFilter"),label:l?.label})})]}),e.jsx(me,{id:Yt,className:w.chatSettingsSeparator,checked:C,label:_("labels.shouldStream"),onChange:Ys,"aria-labelledby":Jt,onRenderLabel:l=>e.jsx($,{labelId:Jt,fieldId:Yt,helpText:_("helpTexts.streamChat"),label:l?.label})}),le&&e.jsx(_l,{})]})]})]})]})})},Pl=()=>{const[s,t]=o.useState([]),[n,r]=o.useState([]),[a,i]=o.useState("File Collection"),d=u=>{const x=Array.from(u.target.files||[]).map(f=>({name:f.name,size:`${(f.size/1024).toFixed(2)} KB`,date:new Date().toLocaleString()}));t(f=>[...f,...x])},c=()=>{s.length>0&&(r(u=>[...u,{name:`Group ${u.length+1}`,files:s}]),t([]))};return e.jsxs("div",{className:"files-section",children:[e.jsxs("div",{className:"tabs",children:[e.jsx("button",{className:a==="File Collection"?"active":"",onClick:()=>i("File Collection"),children:"File Collection"}),e.jsx("button",{className:a==="GraphRAG Collection"?"active":"",onClick:()=>i("GraphRAG Collection"),children:"GraphRAG Collection"})]}),a==="File Collection"&&e.jsxs("div",{className:"file-collection",children:[e.jsxs("div",{className:"upload-section",children:[e.jsxs("label",{htmlFor:"file-upload",className:"upload-box",children:[e.jsxs("div",{children:[e.jsx("span",{children:"📤"}),e.jsx("p",{children:"Drop File Here - or - Click to Upload"})]}),e.jsx("input",{id:"file-upload",type:"file",multiple:!0,onChange:d,style:{display:"none"}})]}),e.jsx("small",{children:"Supported file types: .png, .jpeg, .pdf, etc. (Max size: 1GB)"})]}),e.jsxs("div",{className:"file-list",children:[e.jsx("h3",{children:"Files"}),s.length>0?e.jsx("ul",{children:s.map((u,p)=>e.jsxs("li",{children:[e.jsx("span",{children:u.name}),e.jsx("span",{children:u.size}),e.jsx("span",{children:u.date})]},p))}):e.jsx("p",{children:"No files uploaded yet."})]}),e.jsxs("div",{className:"group-section",children:[e.jsx("h3",{children:"Groups"}),e.jsx("button",{onClick:c,children:"Create Group"}),n.length>0?e.jsx("ul",{children:n.map((u,p)=>e.jsxs("li",{children:[e.jsx("strong",{children:u.name}),e.jsx("ul",{children:u.files.map((x,f)=>e.jsx("li",{children:x.name},f))})]},p))}):e.jsx("p",{children:"No groups created yet."})]})]}),a==="GraphRAG Collection"&&e.jsxs("div",{className:"graphrag-collection",children:[e.jsx("h3",{children:"GraphRAG Collection"}),e.jsx("p",{children:"Manage GraphRAG files here."})]})]})},Fl=()=>{const[s,t]=o.useState("about");return e.jsx("div",{className:"help-container",children:e.jsxs("div",{className:"dropdown-container",children:[e.jsxs("div",{className:`dropdown-item ${s==="about"?"active":""}`,onClick:()=>t("about"),children:[e.jsx("h3",{children:"About"}),s==="about"&&e.jsxs("div",{className:"dropdown-content",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Version:"})," Local"]}),e.jsx("h3",{children:"Braein Energy AI Data Explorer"}),e.jsx("p",{children:"Welcome to the Braein Energy AI Data Explorer! This platform is designed to help users manage files, explore resources, and interact with AI-powered tools to streamline workflows and enhance productivity. Navigate through the tabs to explore the various features we offer."})]})]}),e.jsxs("div",{className:`dropdown-item ${s==="userGuide"?"active":""}`,onClick:()=>t("userGuide"),children:[e.jsx("h3",{children:"User Guide"}),s==="userGuide"&&e.jsxs("div",{className:"dropdown-content",children:[e.jsx("h4",{children:"1. Add Your AI Models"}),e.jsxs("p",{children:["Navigate to the ",e.jsx("strong",{children:"Resources"})," tab to manage LLMs and embeddings:"]}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"View:"})," Explore available LLMs and embeddings in their respective sections."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Add:"})," Add new LLMs or embeddings by providing required details and configuration."]})]}),e.jsx("h4",{children:"2. Manage Files"}),e.jsxs("p",{children:["Use the ",e.jsx("strong",{children:"Files"})," tab to upload, index, and group files. The platform supports various formats, including PDFs, images, and more. Use the grouping feature to manage multiple files."]}),e.jsx("h4",{children:"3. Query and Explore Data"}),e.jsxs("p",{children:["Leverage the ",e.jsx("strong",{children:"Chat"})," tab to ask questions about uploaded files or indexed data. The AI assistant provides contextual answers and highlights relevant sections in the uploaded documents."]}),e.jsx("h4",{children:"4. Configuration"}),e.jsxs("p",{children:["Visit the ",e.jsx("strong",{children:"Settings"})," tab to configure platform preferences, toggle between light/dark modes, and manage user profiles."]}),e.jsx("h4",{children:"5. Integration"}),e.jsx("p",{children:"The platform integrates with various AI and data management tools, allowing seamless interaction with large language models, embedding systems, and custom data sets."}),e.jsx("h4",{children:"6. Advanced Features"}),e.jsxs("p",{children:[e.jsx("strong",{children:"File Groups:"})," Use the grouping feature to manage related documents together.",e.jsx("br",{}),e.jsx("strong",{children:"Interactive Highlights:"})," While querying files, the assistant automatically highlights relevant sections."]}),e.jsx("p",{children:"Explore more features by navigating through the tabs!"})]})]})]})})},El="_sectionHeader_1hxtk_41",Rl="_dropdownButton_1hxtk_65",Dl="_toggleContainer_1hxtk_95",Ml="_toggleButton_1hxtk_109",$l="_header_1hxtk_13",Bl="_headerContainer_1hxtk_23",zl="_layout_1hxtk_1",Ol="_headerTitleContainer_1hxtk_191",ql="_headerLogo_1hxtk_205",Ul="_headerTitle_1hxtk_191",Gl="_headerNavList_1hxtk_225",Vl="_show_1hxtk_253",Hl="_headerNavPageLink_1hxtk_261",Ql="_headerNavPageLinkActive_1hxtk_297",Wl="_headerNavLeftMargin_1hxtk_315",Kl="_microsoftLogo_1hxtk_323",Jl="_githubLogo_1hxtk_325",Yl="_menuToggle_1hxtk_333",Xl="_loginMenuContainer_1hxtk_353",Zl="_headerRightText_1hxtk_433",P={sectionHeader:El,dropdownButton:Rl,toggleContainer:Dl,toggleButton:Ml,header:$l,headerContainer:Bl,layout:zl,headerTitleContainer:Ol,headerLogo:ql,headerTitle:Ul,headerNavList:Gl,show:Vl,headerNavPageLink:Hl,headerNavPageLinkActive:Ql,headerNavLeftMargin:Wl,microsoftLogo:Kl,githubLogo:Jl,menuToggle:Yl,loginMenuContainer:Xl,headerRightText:Zl},ec="/assets/braein-DhY03L2-.png",tc="/assets/ist_logo_footer-BdflhHut.svg",sc="_loginButton_1njer_1",nc={loginButton:sc},ac=()=>{const{instance:s}=_e(),{loggedIn:t,setLoggedIn:n}=o.useContext(je),r=s.getActiveAccount(),[a,i]=o.useState(""),{t:d}=A();o.useEffect(()=>{(async()=>{i(await ct(s)??"")})()},[]);const c=()=>{s.loginPopup({...za,redirectUri:fs()}).catch(p=>console.log(p)).then(async()=>{n(await pt(s)),i(await ct(s)??"")})},u=()=>{r?s.logoutPopup({mainWindowRedirectUri:"/",account:s.getActiveAccount()}).catch(p=>console.log(p)).then(async()=>{n(await pt(s)),i(await ct(s)??"")}):Ua()};return e.jsx(qe,{text:t?`${d("logout")}
${a}`:`${d("login")}`,className:nc.loginButton,onClick:t?u:c})},ls=()=>{o.useState(!0);const{t:s}=A(),[t,n]=o.useState(!1),r=o.useRef(null),a=()=>{n(!t)},i=d=>{r.current&&!r.current.contains(d.target)&&n(!1)};return o.useEffect(()=>(t?document.addEventListener("mousedown",i):document.removeEventListener("mousedown",i),()=>{document.removeEventListener("mousedown",i)}),[t]),e.jsxs("div",{className:P.layout,children:[e.jsx("header",{className:P.header,role:"banner",children:e.jsxs("div",{className:P.headerContainer,ref:r,children:[e.jsx(rt,{to:"/",className:P.headerTitleContainer,children:e.jsx("h3",{className:P.headerTitle,children:s("headerTitle")})}),e.jsxs("div",{className:P.headerContainer,children:[e.jsx(rt,{to:"/",className:P.headerTitleContainer,style:{width:"100px",height:"auto",marginLeft:"10px"},children:e.jsx("img",{src:ec,className:"navbar-logo",style:{background:"none",width:"100px",height:"auto"}})}),e.jsx("p",{style:{color:"white",fontSize:"20px",fontWeight:"bold",margin:"0 10px"},children:"|"}),e.jsx(rt,{to:"/",className:P.headerTitleContainer,style:{width:"100px",height:"auto"},children:e.jsx("img",{src:tc,className:"navbar-logo",style:{background:"none",width:"100px",height:"auto"}})})]}),e.jsxs("div",{children:[e.jsx("nav",{children:e.jsxs("ul",{className:`${P.headerNavList} ${t?P.show:""}`,children:[e.jsx("li",{children:e.jsx(Ee,{to:"/",className:({isActive:d})=>d?P.headerNavPageLinkActive:P.headerNavPageLink,onClick:()=>n(!1),children:s("chat")})}),e.jsx("li",{children:e.jsx(Ee,{to:"/docs",className:({isActive:d})=>d?P.headerNavPageLinkActive:P.headerNavPageLink,onClick:()=>n(!1),children:"Files"})}),e.jsx("li",{children:e.jsx(Ee,{to:"/Resources",className:({isActive:d})=>d?P.headerNavPageLinkActive:P.headerNavPageLink,onClick:()=>n(!1),children:"Resources"})}),e.jsx("li",{children:e.jsx(Ee,{to:"/Settings",className:({isActive:d})=>d?P.headerNavPageLinkActive:P.headerNavPageLink,onClick:()=>n(!1),children:"Settings"})}),e.jsx("li",{children:e.jsx(Ee,{to:"/help",className:({isActive:d})=>d?P.headerNavPageLinkActive:P.headerNavPageLink,onClick:()=>n(!1),children:"Help"})})]})}),e.jsxs("div",{className:P.loginMenuContainer,children:[le&&e.jsx(ac,{}),e.jsx(te,{iconProps:{iconName:"GlobalNavButton"},className:P.menuToggle,onClick:a,ariaLabel:s("labels.toggleMenu")})]})]})]})}),e.jsx(vn,{})]})},oc=()=>{const[s,t]=o.useState(!1);if(le){var n=new jn(Ba);return!n.getActiveAccount()&&n.getAllAccounts().length>0&&n.setActiveAccount(n.getActiveAccount()),n.addEventCallback(r=>{if(r.eventType===_n.LOGIN_SUCCESS&&r.payload){const a=r.payload;n.setActiveAccount(a)}}),o.useEffect(()=>{(async()=>{t(await pt(n))})()},[]),e.jsx(Cn,{instance:n,children:e.jsx(je.Provider,{value:{loggedIn:s,setLoggedIn:t},children:e.jsx(ls,{})})})}else return e.jsx(je.Provider,{value:{loggedIn:s,setLoggedIn:t},children:e.jsx(ls,{})})};wn();const rc=Tn([{path:"/",element:e.jsx(oc,{}),children:[{index:!0,element:e.jsx(Nl,{})},{path:"files",element:e.jsx(Pl,{})},{path:"Help",element:e.jsx(Fl,{})},{path:"docs",lazy:()=>it(()=>import("./Docs-ZC7OVyd3.js"),__vite__mapDeps([0,1,2,3]))},{path:"qa",lazy:()=>it(()=>import("./Ask-rzQ-HxZU.js"),__vite__mapDeps([4,1,2,3,5]))},{path:"*",lazy:()=>it(()=>import("./NoPage-D5z2sDZN.js"),__vite__mapDeps([6,1]))}]}]);kn.createRoot(document.getElementById("root")).render(e.jsx(In.StrictMode,{children:e.jsx(Ln,{i18n:cs,children:e.jsx(An,{children:e.jsx(Nn,{router:rc})})})}));export{ns as A,ui as E,re as G,$ as H,je as L,ri as Q,U as R,dl as S,_l as T,yl as U,Q as V,Ll as a,ee as b,ei as c,Ss as d,$i as e,Tl as f,ce as g,jl as h,Va as i,uc as j,vs as l,$e as r,le as u};
//# sourceMappingURL=index-Darz4a5I.js.map
